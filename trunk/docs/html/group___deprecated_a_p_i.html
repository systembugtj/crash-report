<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="icon" href="../favicon.ico" type="image/x-icon" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>CrashRpt: Obsolete Functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>

<table border="0" bgcolor="#FFFFFF" cellspacing="5">
 <tr>
  <td rowspan="2"><img src="../logo.png" alt="Logo" /></td>
  <td><font family="Arial" size="+2">crashrpt</font></td>
 </tr>
 <tr>
  <td><i>A crash reporting system for Windows applications</i></td>
 </tr>


</table>


</body>
<!-- Generated by Doxygen 1.5.9 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Contents</span></a></li>
      <li><a href="modules.html"><span>API&nbsp;Reference</span></a></li>
      <li><a href="files.html"><span>File&nbsp;Reference</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Obsolete Functions</h1><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g31ccdad9eea92035f3e18354ad71e9a1"></a><!-- doxytag: member="DeprecatedAPI::Install" ref="g31ccdad9eea92035f3e18354ad71e9a1" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___deprecated_a_p_i.html#g31ccdad9eea92035f3e18354ad71e9a1">Install</a>&nbsp;&nbsp;&nbsp;InstallA</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Character set-independent mapping of <a class="el" href="group___deprecated_a_p_i.html#g998a0ee24f52ffb13143e0d430ae930e" title="Installs exception handlers for the current process.">InstallW()</a> and <a class="el" href="group___deprecated_a_p_i.html#g6627ad863e23cdf32c836a1225f618cc">InstallA()</a> functions. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g6d0853bb511fd38b1949f9e374e9a50f"></a><!-- doxytag: member="DeprecatedAPI::AddFile" ref="g6d0853bb511fd38b1949f9e374e9a50f" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___deprecated_a_p_i.html#g6d0853bb511fd38b1949f9e374e9a50f">AddFile</a>&nbsp;&nbsp;&nbsp;AddFileA</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Character set-independent mapping of <a class="el" href="group___deprecated_a_p_i.html#g7d2321d23ab38c5db28d70f1f67494ef" title="Adds a file to the crash report.">AddFileW()</a> and <a class="el" href="group___deprecated_a_p_i.html#gcb0177a3c73972919279172ed2366890">AddFileA()</a> functions. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g7bb0d6cebaf9c3aa3aae05d0412b6176"></a><!-- doxytag: member="DeprecatedAPI::crAddFile" ref="g7bb0d6cebaf9c3aa3aae05d0412b6176" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___deprecated_a_p_i.html#g7bb0d6cebaf9c3aa3aae05d0412b6176">crAddFile</a>&nbsp;&nbsp;&nbsp;crAddFileA</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Character set-independent mapping of <a class="el" href="group___deprecated_a_p_i.html#gc02c32fc397369cbd99cb62e4219b4ae" title="Adds a file to crash report.">crAddFileW()</a> and <a class="el" href="group___deprecated_a_p_i.html#g2e56e3ca68ac753e52678fd8f0abf7e1">crAddFileA()</a> functions. <br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">LPVOID&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___deprecated_a_p_i.html#g998a0ee24f52ffb13143e0d430ae930e">InstallW</a> (<a class="el" href="group___crash_rpt_a_p_i.html#ga5587485696de27611c497382de06ce3">LPGETLOGFILE</a> pfnCallback, LPCWSTR pszEmailTo, LPCWSTR pszEmailSubject)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Installs exception handlers for the current process.  <a href="#g998a0ee24f52ffb13143e0d430ae930e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">LPVOID&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___deprecated_a_p_i.html#g6627ad863e23cdf32c836a1225f618cc">InstallA</a> (<a class="el" href="group___crash_rpt_a_p_i.html#ga5587485696de27611c497382de06ce3">LPGETLOGFILE</a> pfnCallback, LPCSTR pszEmailTo, LPCSTR pszEmailSubject)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___deprecated_a_p_i.html#g18467246d8faba14f24c9a6740c7c293">Uninstall</a> (LPVOID lpState)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Uninstalls the exception filters set up by <a class="el" href="group___deprecated_a_p_i.html#g31ccdad9eea92035f3e18354ad71e9a1" title="Character set-independent mapping of InstallW() and InstallA() functions.">Install()</a>.  <a href="#g18467246d8faba14f24c9a6740c7c293"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___deprecated_a_p_i.html#g7d2321d23ab38c5db28d70f1f67494ef">AddFileW</a> (LPVOID lpState, LPCWSTR pszFile, LPCWSTR pszDesc)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adds a file to the crash report.  <a href="#g7d2321d23ab38c5db28d70f1f67494ef"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___deprecated_a_p_i.html#gcb0177a3c73972919279172ed2366890">AddFileA</a> (LPVOID lpState, LPCSTR pszFile, LPCSTR pszDesc)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___deprecated_a_p_i.html#g1f0e8984e4800b898a1131c0d7238786">GenerateErrorReport</a> (LPVOID lpState, PEXCEPTION_POINTERS pExInfo)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generates the crash report.  <a href="#g1f0e8984e4800b898a1131c0d7238786"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___deprecated_a_p_i.html#g7a9a699378388487a725689d6571e7cb">crInstallToCurrentThread</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Installs exception handlers to the current thread.  <a href="#g7a9a699378388487a725689d6571e7cb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___deprecated_a_p_i.html#gc02c32fc397369cbd99cb62e4219b4ae">crAddFileW</a> (LPCWSTR pszFile, LPCWSTR pszDesc)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adds a file to crash report.  <a href="#gc02c32fc397369cbd99cb62e4219b4ae"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___deprecated_a_p_i.html#g2e56e3ca68ac753e52678fd8f0abf7e1">crAddFileA</a> (LPCSTR pszFile, LPCSTR pszDesc)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___deprecated_a_p_i.html#gb993bf6a9e7b2f909263d8032496b4dc">crExceptionFilter</a> (unsigned int code, struct _EXCEPTION_POINTERS *ep)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Can be used as a SEH exception filter.  <a href="#gb993bf6a9e7b2f909263d8032496b4dc"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="gcb0177a3c73972919279172ed2366890"></a><!-- doxytag: member="CrashRpt.h::AddFileA" ref="gcb0177a3c73972919279172ed2366890" args="(LPVOID lpState, LPCSTR pszFile, LPCSTR pszDesc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AddFileA           </td>
          <td>(</td>
          <td class="paramtype">LPVOID&nbsp;</td>
          <td class="paramname"> <em>lpState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCSTR&nbsp;</td>
          <td class="paramname"> <em>pszFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCSTR&nbsp;</td>
          <td class="paramname"> <em>pszDesc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Adds a file to the crash report. <p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>lpState</em>&nbsp;</td><td>State information returned from <a class="el" href="group___deprecated_a_p_i.html#g31ccdad9eea92035f3e18354ad71e9a1" title="Character set-independent mapping of InstallW() and InstallA() functions.">Install()</a>, ignored and should be NULL. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszFile</em>&nbsp;</td><td>Fully qualified file name. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszDesc</em>&nbsp;</td><td>Description of the file, used by the Error Report Details dialog.</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
This function can be called anytime after <a class="el" href="group___deprecated_a_p_i.html#g31ccdad9eea92035f3e18354ad71e9a1" title="Character set-independent mapping of InstallW() and InstallA() functions.">Install()</a> to add one or more files to the generated crash report.<p>
<em>pszFile</em> should be a valid absolute path of a file to add to crash report.<p>
<em>pszDesc</em> is a description of a file. It can be NULL.<p>
Function fails if <em>pszFile</em> doesn't exist at the moment of function call.<p>
<a class="el" href="group___deprecated_a_p_i.html#g7d2321d23ab38c5db28d70f1f67494ef" title="Adds a file to the crash report.">AddFileW()</a> and <a class="el" href="group___deprecated_a_p_i.html#gcb0177a3c73972919279172ed2366890">AddFileA()</a> are wide-character and multibyte-character versions of <a class="el" href="group___deprecated_a_p_i.html#g6d0853bb511fd38b1949f9e374e9a50f" title="Character set-independent mapping of AddFileW() and AddFileA() functions.">AddFile()</a>. The <a class="el" href="group___deprecated_a_p_i.html#g6d0853bb511fd38b1949f9e374e9a50f" title="Character set-independent mapping of AddFileW() and AddFileA() functions.">AddFile()</a> macro defines character set independent mapping for these functions.  
</div>
</div><p>
<a class="anchor" name="g7d2321d23ab38c5db28d70f1f67494ef"></a><!-- doxytag: member="CrashRpt.h::AddFileW" ref="g7d2321d23ab38c5db28d70f1f67494ef" args="(LPVOID lpState, LPCWSTR pszFile, LPCWSTR pszDesc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AddFileW           </td>
          <td>(</td>
          <td class="paramtype">LPVOID&nbsp;</td>
          <td class="paramname"> <em>lpState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCWSTR&nbsp;</td>
          <td class="paramname"> <em>pszFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCWSTR&nbsp;</td>
          <td class="paramname"> <em>pszDesc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Adds a file to the crash report. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>lpState</em>&nbsp;</td><td>State information returned from <a class="el" href="group___deprecated_a_p_i.html#g31ccdad9eea92035f3e18354ad71e9a1" title="Character set-independent mapping of InstallW() and InstallA() functions.">Install()</a>, ignored and should be NULL. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszFile</em>&nbsp;</td><td>Fully qualified file name. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszDesc</em>&nbsp;</td><td>Description of the file, used by the Error Report Details dialog.</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
This function can be called anytime after <a class="el" href="group___deprecated_a_p_i.html#g31ccdad9eea92035f3e18354ad71e9a1" title="Character set-independent mapping of InstallW() and InstallA() functions.">Install()</a> to add one or more files to the generated crash report.<p>
<em>pszFile</em> should be a valid absolute path of a file to add to crash report.<p>
<em>pszDesc</em> is a description of a file. It can be NULL.<p>
Function fails if <em>pszFile</em> doesn't exist at the moment of function call.<p>
<a class="el" href="group___deprecated_a_p_i.html#g7d2321d23ab38c5db28d70f1f67494ef" title="Adds a file to the crash report.">AddFileW()</a> and <a class="el" href="group___deprecated_a_p_i.html#gcb0177a3c73972919279172ed2366890">AddFileA()</a> are wide-character and multibyte-character versions of <a class="el" href="group___deprecated_a_p_i.html#g6d0853bb511fd38b1949f9e374e9a50f" title="Character set-independent mapping of AddFileW() and AddFileA() functions.">AddFile()</a>. The <a class="el" href="group___deprecated_a_p_i.html#g6d0853bb511fd38b1949f9e374e9a50f" title="Character set-independent mapping of AddFileW() and AddFileA() functions.">AddFile()</a> macro defines character set independent mapping for these functions. 
</div>
</div><p>
<a class="anchor" name="g2e56e3ca68ac753e52678fd8f0abf7e1"></a><!-- doxytag: member="CrashRpt.h::crAddFileA" ref="g2e56e3ca68ac753e52678fd8f0abf7e1" args="(LPCSTR pszFile, LPCSTR pszDesc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crAddFileA           </td>
          <td>(</td>
          <td class="paramtype">LPCSTR&nbsp;</td>
          <td class="paramname"> <em>pszFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCSTR&nbsp;</td>
          <td class="paramname"> <em>pszDesc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Adds a file to crash report. <p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>This function returns zero if succeeded.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszFile</em>&nbsp;</td><td>Absolute path to the file to add. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszDesc</em>&nbsp;</td><td>File description (used in Error Report Details dialog).</td></tr>
  </table>
</dl>
<dl class="note" compact><dt><b>Note:</b></dt><dd>This function is deprecated and will be removed in one of the future releases. It is recommended to use <a class="el" href="group___crash_rpt_a_p_i.html#g382c00cf76818ba1a66eb89715a030ea" title="Character set-independent mapping of crAddFile2W() and crAddFile2A() functions.">crAddFile2()</a> function instead.</dd></dl>
This function can be called anytime after <a class="el" href="group___crash_rpt_a_p_i.html#g24acb589d629460590d85735e12b5337" title="Character set-independent mapping of crInstallW() and crInstallA() functions.">crInstall()</a> to add one or more files to the generated crash report.<p>
When this function is called, the file is marked to be added to the error report, then the function returns control to the caller. When crash occurs, all marked files are added to the report by the <b>CrashSender.exe</b> process. If a file is locked by someone for exclusive access, the file won't be included. Inside of <a class="el" href="group___crash_rpt_a_p_i.html#ga5587485696de27611c497382de06ce3">LPGETLOGFILE</a> crash callback, ensure files to be included are acessible for reading.<p>
<em>pszFile</em> should be a valid absolute path of a file to add to crash report.<p>
<em>pszDesc</em> is a description of a file. It can be NULL.<p>
This function fails if <em>pszFile</em> doesn't exist at the moment of function call.<p>
The <a class="el" href="group___deprecated_a_p_i.html#gc02c32fc397369cbd99cb62e4219b4ae" title="Adds a file to crash report.">crAddFileW()</a> and <a class="el" href="group___deprecated_a_p_i.html#g2e56e3ca68ac753e52678fd8f0abf7e1">crAddFileA()</a> are wide-character and multibyte-character versions of <a class="el" href="group___deprecated_a_p_i.html#g7bb0d6cebaf9c3aa3aae05d0412b6176" title="Character set-independent mapping of crAddFileW() and crAddFileA() functions.">crAddFile()</a> function. The <a class="el" href="group___deprecated_a_p_i.html#g7bb0d6cebaf9c3aa3aae05d0412b6176" title="Character set-independent mapping of crAddFileW() and crAddFileA() functions.">crAddFile()</a> macro defines character set independent mapping.<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group___deprecated_a_p_i.html#gc02c32fc397369cbd99cb62e4219b4ae" title="Adds a file to crash report.">crAddFileW()</a>, <a class="el" href="group___deprecated_a_p_i.html#g2e56e3ca68ac753e52678fd8f0abf7e1">crAddFileA()</a>, <a class="el" href="group___deprecated_a_p_i.html#g7bb0d6cebaf9c3aa3aae05d0412b6176" title="Character set-independent mapping of crAddFileW() and crAddFileA() functions.">crAddFile()</a> </dd></dl>
 
</div>
</div><p>
<a class="anchor" name="gc02c32fc397369cbd99cb62e4219b4ae"></a><!-- doxytag: member="CrashRpt.h::crAddFileW" ref="gc02c32fc397369cbd99cb62e4219b4ae" args="(LPCWSTR pszFile, LPCWSTR pszDesc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crAddFileW           </td>
          <td>(</td>
          <td class="paramtype">LPCWSTR&nbsp;</td>
          <td class="paramname"> <em>pszFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCWSTR&nbsp;</td>
          <td class="paramname"> <em>pszDesc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Adds a file to crash report. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>This function returns zero if succeeded.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszFile</em>&nbsp;</td><td>Absolute path to the file to add. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszDesc</em>&nbsp;</td><td>File description (used in Error Report Details dialog).</td></tr>
  </table>
</dl>
<dl class="note" compact><dt><b>Note:</b></dt><dd>This function is deprecated and will be removed in one of the future releases. It is recommended to use <a class="el" href="group___crash_rpt_a_p_i.html#g382c00cf76818ba1a66eb89715a030ea" title="Character set-independent mapping of crAddFile2W() and crAddFile2A() functions.">crAddFile2()</a> function instead.</dd></dl>
This function can be called anytime after <a class="el" href="group___crash_rpt_a_p_i.html#g24acb589d629460590d85735e12b5337" title="Character set-independent mapping of crInstallW() and crInstallA() functions.">crInstall()</a> to add one or more files to the generated crash report.<p>
When this function is called, the file is marked to be added to the error report, then the function returns control to the caller. When crash occurs, all marked files are added to the report by the <b>CrashSender.exe</b> process. If a file is locked by someone for exclusive access, the file won't be included. Inside of <a class="el" href="group___crash_rpt_a_p_i.html#ga5587485696de27611c497382de06ce3">LPGETLOGFILE</a> crash callback, ensure files to be included are acessible for reading.<p>
<em>pszFile</em> should be a valid absolute path of a file to add to crash report.<p>
<em>pszDesc</em> is a description of a file. It can be NULL.<p>
This function fails if <em>pszFile</em> doesn't exist at the moment of function call.<p>
The <a class="el" href="group___deprecated_a_p_i.html#gc02c32fc397369cbd99cb62e4219b4ae" title="Adds a file to crash report.">crAddFileW()</a> and <a class="el" href="group___deprecated_a_p_i.html#g2e56e3ca68ac753e52678fd8f0abf7e1">crAddFileA()</a> are wide-character and multibyte-character versions of <a class="el" href="group___deprecated_a_p_i.html#g7bb0d6cebaf9c3aa3aae05d0412b6176" title="Character set-independent mapping of crAddFileW() and crAddFileA() functions.">crAddFile()</a> function. The <a class="el" href="group___deprecated_a_p_i.html#g7bb0d6cebaf9c3aa3aae05d0412b6176" title="Character set-independent mapping of crAddFileW() and crAddFileA() functions.">crAddFile()</a> macro defines character set independent mapping.<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group___deprecated_a_p_i.html#gc02c32fc397369cbd99cb62e4219b4ae" title="Adds a file to crash report.">crAddFileW()</a>, <a class="el" href="group___deprecated_a_p_i.html#g2e56e3ca68ac753e52678fd8f0abf7e1">crAddFileA()</a>, <a class="el" href="group___deprecated_a_p_i.html#g7bb0d6cebaf9c3aa3aae05d0412b6176" title="Character set-independent mapping of crAddFileW() and crAddFileA() functions.">crAddFile()</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="gb993bf6a9e7b2f909263d8032496b4dc"></a><!-- doxytag: member="CrashRpt.h::crExceptionFilter" ref="gb993bf6a9e7b2f909263d8032496b4dc" args="(unsigned int code, struct _EXCEPTION_POINTERS *ep)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crExceptionFilter           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct _EXCEPTION_POINTERS *&nbsp;</td>
          <td class="paramname"> <em>ep</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Can be used as a SEH exception filter. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>This function returns <code>EXCEPTION_EXECUTE_HANDLER</code> if succeeds, else <code>EXCEPTION_CONTINUE_SEARCH</code>.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>code</em>&nbsp;</td><td>Exception code. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ep</em>&nbsp;</td><td>Exception pointers.</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
As of v.1.2.8, this function is declared deprecated. It may be removed in one of the future releases.<p>
This function can be called instead of a SEH exception filter inside of __try{}__except(Expression){} statement. The function generates a error report and returns control to the exception handler block.<p>
The exception code is usually retrieved with <b>GetExceptionCode()</b> intrinsic function and the exception pointers are retrieved with <b>GetExceptionInformation()</b> intrinsic function.<p>
If an error occurs, this function returns <code>EXCEPTION_CONTINUE_SEARCH</code>. Use <a class="el" href="group___crash_rpt_a_p_i.html#g062f47d5f7284d72793c60699c7caa33" title="Defines character set-independent mapping for crGetLastErrorMsgW() and crGetLastErrorMsgA()...">crGetLastErrorMsg()</a> to retrieve the error message on fail.<p>
The following example shows how to use <a class="el" href="group___deprecated_a_p_i.html#gb993bf6a9e7b2f909263d8032496b4dc" title="Can be used as a SEH exception filter.">crExceptionFilter()</a>.<p>
<div class="fragment"><pre class="fragment">     <span class="keywordtype">int</span>* p = NULL;   <span class="comment">// pointer to NULL</span>
     __try
     {
        *p = 13; <span class="comment">// causes an access violation exception;</span>
     }
     __except(<a class="code" href="group___deprecated_a_p_i.html#gb993bf6a9e7b2f909263d8032496b4dc" title="Can be used as a SEH exception filter.">crExceptionFilter</a>(GetExceptionCode(), GetExceptionInformation()))
     {   
       <span class="comment">// Terminate program</span>
       ExitProcess(1);
     }
</pre></div> 
</div>
</div><p>
<a class="anchor" name="g7a9a699378388487a725689d6571e7cb"></a><!-- doxytag: member="CrashRpt.h::crInstallToCurrentThread" ref="g7a9a699378388487a725689d6571e7cb" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crInstallToCurrentThread           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Installs exception handlers to the current thread. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>This function returns zero if succeeded.</dd></dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
This function sets exception handlers for the caller thread. If you have several execution threads, you ought to call the function for each thread, except the main one.<p>
The list of C++ exception/error handlers installed with this function:<ul>
<li>terminate handler [ <code>set_terminate()</code> ]</li><li>unexpected handler [ <code>set_unexpected()</code> ]</li><li>floating point error handler [ <code>signal(SIGFPE)</code> ]</li><li>illegal instruction handler [ <code>signal(SIGILL)</code> ]</li><li>illegal storage access handler [ <code>signal(SIGSEGV)</code> ]</li></ul>
<p>
The <a class="el" href="group___crash_rpt_a_p_i.html#g24acb589d629460590d85735e12b5337" title="Character set-independent mapping of crInstallW() and crInstallA() functions.">crInstall()</a> function automatically installs C++ exception handlers for the main thread, so no need to call <a class="el" href="group___deprecated_a_p_i.html#g7a9a699378388487a725689d6571e7cb" title="Installs exception handlers to the current thread.">crInstallToCurrentThread()</a> for the main thread.<p>
This function fails if calling it twice for the same thread. When this function fails, use <a class="el" href="group___crash_rpt_a_p_i.html#g062f47d5f7284d72793c60699c7caa33" title="Defines character set-independent mapping for crGetLastErrorMsgW() and crGetLastErrorMsgA()...">crGetLastErrorMsg()</a> to retrieve the error message.<p>
Call <a class="el" href="group___crash_rpt_a_p_i.html#gaf56dbee81338534d96ab23f694be43c" title="Uninstalls C++ exception handlers from the current thread.">crUninstallFromCurrentThread()</a> to uninstall C++ exception handlers from current thread.<p>
This function is deprecatd. The <a class="el" href="group___crash_rpt_a_p_i.html#g6fe5cff31697f687b29dc73cd34d72b4" title="Installs exception handlers to the caller thread.">crInstallToCurrentThread2()</a> function gives better control of what exception handlers to install.<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group___crash_rpt_a_p_i.html#g6fe5cff31697f687b29dc73cd34d72b4" title="Installs exception handlers to the caller thread.">crInstallToCurrentThread2()</a>, <a class="el" href="group___crash_rpt_a_p_i.html#gaf56dbee81338534d96ab23f694be43c" title="Uninstalls C++ exception handlers from the current thread.">crUninstallFromCurrentThread()</a>, <a class="el" href="class_cr_thread_auto_install_helper.html" title="Installs (uninstalls) exception handlers for the caller thread in class&#39; constructor...">CrThreadAutoInstallHelper</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="g1f0e8984e4800b898a1131c0d7238786"></a><!-- doxytag: member="CrashRpt.h::GenerateErrorReport" ref="g1f0e8984e4800b898a1131c0d7238786" args="(LPVOID lpState, PEXCEPTION_POINTERS pExInfo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GenerateErrorReport           </td>
          <td>(</td>
          <td class="paramtype">LPVOID&nbsp;</td>
          <td class="paramname"> <em>lpState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PEXCEPTION_POINTERS&nbsp;</td>
          <td class="paramname"> <em>pExInfo</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Generates the crash report. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>lpState</em>&nbsp;</td><td>State information returned from <a class="el" href="group___deprecated_a_p_i.html#g31ccdad9eea92035f3e18354ad71e9a1" title="Character set-independent mapping of InstallW() and InstallA() functions.">Install()</a>, ignored and should be NULL. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pExInfo</em>&nbsp;</td><td>Pointer to an EXCEPTION_POINTERS structure, can be NULL.</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
Call this function to manually generate a crash report.<p>
The crash report contains the crash minidump, crash description in XML format and (optionally) additional files.<p>
<em>pExInfo</em> defines the exception pointers for generating crash minidump file. If <em>pExInfo</em> is NULL, current CPU state is used to create exception pointers.<p>
This function generates the error report and returns control to the caller. It doesn't terminate the caller process. 
</div>
</div><p>
<a class="anchor" name="g6627ad863e23cdf32c836a1225f618cc"></a><!-- doxytag: member="CrashRpt.h::InstallA" ref="g6627ad863e23cdf32c836a1225f618cc" args="(LPGETLOGFILE pfnCallback, LPCSTR pszEmailTo, LPCSTR pszEmailSubject)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LPVOID InstallA           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___crash_rpt_a_p_i.html#ga5587485696de27611c497382de06ce3">LPGETLOGFILE</a>&nbsp;</td>
          <td class="paramname"> <em>pfnCallback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCSTR&nbsp;</td>
          <td class="paramname"> <em>pszEmailTo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCSTR&nbsp;</td>
          <td class="paramname"> <em>pszEmailSubject</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Installs exception handlers for the current process. <p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pfnCallback</em>&nbsp;</td><td>Client crash callback. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszEmailTo</em>&nbsp;</td><td>Email address to send crash report to. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszEmailSubject</em>&nbsp;</td><td>Subject of the E-mail message.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Always returns NULL.</dd></dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
This function installs SEH exception filter for the caller process. It also installs various C++ exception/error handlers. For the list of handlers, please see <a class="el" href="group___crash_rpt_a_p_i.html#g24acb589d629460590d85735e12b5337" title="Character set-independent mapping of crInstallW() and crInstallA() functions.">crInstall()</a>.<p>
<em>pfnCallback</em> defines the callback function that is called on crash. This parameter can be NULL.<p>
<em>pszEmailTo</em> should be the valid email address of recipient.<p>
<em>pszEmailSubject</em> is the email subject. If this parameter is NULL, the default subject is generated.<p>
This function assumes that CrashSender.exe is located in the same directory as CrashRpt.dll loaded by the caller process. To specify different directory, use <a class="el" href="group___crash_rpt_a_p_i.html#g24acb589d629460590d85735e12b5337" title="Character set-independent mapping of crInstallW() and crInstallA() functions.">crInstall()</a>.<p>
On crash, the error report is sent as E-mail message using address and subject passed to the function as <em>pszEmailTo</em> and <em>pszEmailSubject</em> parameters, respectively.<p>
<a class="el" href="group___deprecated_a_p_i.html#g998a0ee24f52ffb13143e0d430ae930e" title="Installs exception handlers for the current process.">InstallW()</a> and <a class="el" href="group___deprecated_a_p_i.html#g6627ad863e23cdf32c836a1225f618cc">InstallA()</a> are wide-character and multibyte-character versions of <a class="el" href="group___deprecated_a_p_i.html#g31ccdad9eea92035f3e18354ad71e9a1" title="Character set-independent mapping of InstallW() and InstallA() functions.">Install()</a>. The <a class="el" href="group___deprecated_a_p_i.html#g31ccdad9eea92035f3e18354ad71e9a1" title="Character set-independent mapping of InstallW() and InstallA() functions.">Install()</a> macro defines character set independent mapping for these functions.  
</div>
</div><p>
<a class="anchor" name="g998a0ee24f52ffb13143e0d430ae930e"></a><!-- doxytag: member="CrashRpt.h::InstallW" ref="g998a0ee24f52ffb13143e0d430ae930e" args="(LPGETLOGFILE pfnCallback, LPCWSTR pszEmailTo, LPCWSTR pszEmailSubject)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LPVOID InstallW           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___crash_rpt_a_p_i.html#ga5587485696de27611c497382de06ce3">LPGETLOGFILE</a>&nbsp;</td>
          <td class="paramname"> <em>pfnCallback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCWSTR&nbsp;</td>
          <td class="paramname"> <em>pszEmailTo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCWSTR&nbsp;</td>
          <td class="paramname"> <em>pszEmailSubject</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Installs exception handlers for the current process. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pfnCallback</em>&nbsp;</td><td>Client crash callback. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszEmailTo</em>&nbsp;</td><td>Email address to send crash report to. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszEmailSubject</em>&nbsp;</td><td>Subject of the E-mail message.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Always returns NULL.</dd></dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
This function installs SEH exception filter for the caller process. It also installs various C++ exception/error handlers. For the list of handlers, please see <a class="el" href="group___crash_rpt_a_p_i.html#g24acb589d629460590d85735e12b5337" title="Character set-independent mapping of crInstallW() and crInstallA() functions.">crInstall()</a>.<p>
<em>pfnCallback</em> defines the callback function that is called on crash. This parameter can be NULL.<p>
<em>pszEmailTo</em> should be the valid email address of recipient.<p>
<em>pszEmailSubject</em> is the email subject. If this parameter is NULL, the default subject is generated.<p>
This function assumes that CrashSender.exe is located in the same directory as CrashRpt.dll loaded by the caller process. To specify different directory, use <a class="el" href="group___crash_rpt_a_p_i.html#g24acb589d629460590d85735e12b5337" title="Character set-independent mapping of crInstallW() and crInstallA() functions.">crInstall()</a>.<p>
On crash, the error report is sent as E-mail message using address and subject passed to the function as <em>pszEmailTo</em> and <em>pszEmailSubject</em> parameters, respectively.<p>
<a class="el" href="group___deprecated_a_p_i.html#g998a0ee24f52ffb13143e0d430ae930e" title="Installs exception handlers for the current process.">InstallW()</a> and <a class="el" href="group___deprecated_a_p_i.html#g6627ad863e23cdf32c836a1225f618cc">InstallA()</a> are wide-character and multibyte-character versions of <a class="el" href="group___deprecated_a_p_i.html#g31ccdad9eea92035f3e18354ad71e9a1" title="Character set-independent mapping of InstallW() and InstallA() functions.">Install()</a>. The <a class="el" href="group___deprecated_a_p_i.html#g31ccdad9eea92035f3e18354ad71e9a1" title="Character set-independent mapping of InstallW() and InstallA() functions.">Install()</a> macro defines character set independent mapping for these functions. 
</div>
</div><p>
<a class="anchor" name="g18467246d8faba14f24c9a6740c7c293"></a><!-- doxytag: member="CrashRpt.h::Uninstall" ref="g18467246d8faba14f24c9a6740c7c293" args="(LPVOID lpState)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Uninstall           </td>
          <td>(</td>
          <td class="paramtype">LPVOID&nbsp;</td>
          <td class="paramname"> <em>lpState</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Uninstalls the exception filters set up by <a class="el" href="group___deprecated_a_p_i.html#g31ccdad9eea92035f3e18354ad71e9a1" title="Character set-independent mapping of InstallW() and InstallA() functions.">Install()</a>. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>lpState</em>&nbsp;</td><td>State information returned from <a class="el" href="group___deprecated_a_p_i.html#g31ccdad9eea92035f3e18354ad71e9a1" title="Character set-independent mapping of InstallW() and InstallA() functions.">Install()</a>, ignored and should be NULL.</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
Call this function on application exit to uninstall all previously installed exception handlers. 
</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Tue Feb 15 19:41:00 2011 for CrashRpt by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.9 </small></address>
</body>
</html>
