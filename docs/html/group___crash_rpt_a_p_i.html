<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="icon" href="../favicon.ico" type="image/x-icon" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>CrashRpt: CrashRpt Functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>

<table border="0" bgcolor="#FFFFFF" cellspacing="5">
 <tr>
  <td rowspan="2"><img src="../logo.png" alt="Logo" /></td>
  <td><font family="Arial" size="+2">crashrpt</font></td>
 </tr>
 <tr>
  <td><i>A crash reporting system for Windows applications</i></td>
 </tr>


</table>


</body>
<!-- Generated by Doxygen 1.5.9 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Contents</span></a></li>
      <li><a href="modules.html"><span>API&nbsp;Reference</span></a></li>
      <li><a href="files.html"><span>File&nbsp;Reference</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>CrashRpt Functions</h1><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g24acb589d629460590d85735e12b5337"></a><!-- doxytag: member="CrashRptAPI::crInstall" ref="g24acb589d629460590d85735e12b5337" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_a_p_i.html#g24acb589d629460590d85735e12b5337">crInstall</a>&nbsp;&nbsp;&nbsp;crInstallA</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Character set-independent mapping of <a class="el" href="group___crash_rpt_a_p_i.html#gc1f98f531d9a1c67f090768ce4316ffd" title="Installs exception handlers for the caller process.">crInstallW()</a> and <a class="el" href="group___crash_rpt_a_p_i.html#g18a7a7421e1522f787ba451eaf424b0e">crInstallA()</a> functions. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g382c00cf76818ba1a66eb89715a030ea"></a><!-- doxytag: member="CrashRptAPI::crAddFile2" ref="g382c00cf76818ba1a66eb89715a030ea" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_a_p_i.html#g382c00cf76818ba1a66eb89715a030ea">crAddFile2</a>&nbsp;&nbsp;&nbsp;crAddFile2A</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Character set-independent mapping of <a class="el" href="group___crash_rpt_a_p_i.html#gc7c157085cda0769968b172ecdd812f2" title="Adds a file to crash report.">crAddFile2W()</a> and <a class="el" href="group___crash_rpt_a_p_i.html#gb32d6fda8fbea44b55fd4dd78a54cf47">crAddFile2A()</a> functions. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g5bc9d5a06b3ef1bb62e61b109f890730"></a><!-- doxytag: member="CrashRptAPI::crAddProperty" ref="g5bc9d5a06b3ef1bb62e61b109f890730" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_a_p_i.html#g5bc9d5a06b3ef1bb62e61b109f890730">crAddProperty</a>&nbsp;&nbsp;&nbsp;crAddPropertyA</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Character set-independent mapping of <a class="el" href="group___crash_rpt_a_p_i.html#g07229bda698ce870ee8fef189073967f" title="Adds a string property to the crash report.">crAddPropertyW()</a> and <a class="el" href="group___crash_rpt_a_p_i.html#gf46fc13586e64bae226a033499c8979f">crAddPropertyA()</a> functions. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ge5c00c702ef3b674f9c4a509f61728e1"></a><!-- doxytag: member="CrashRptAPI::crAddRegKey" ref="ge5c00c702ef3b674f9c4a509f61728e1" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_a_p_i.html#ge5c00c702ef3b674f9c4a509f61728e1">crAddRegKey</a>&nbsp;&nbsp;&nbsp;crAddRegKeyA</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Character set-independent mapping of <a class="el" href="group___crash_rpt_a_p_i.html#gdeac8208aa4abe735fc966166ffa4073" title="Adds a registry key dump to the crash report.">crAddRegKeyW()</a> and <a class="el" href="group___crash_rpt_a_p_i.html#g11bcc462c7a44dc3a01abffcd037260f">crAddRegKeyA()</a> functions. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g062f47d5f7284d72793c60699c7caa33"></a><!-- doxytag: member="CrashRptAPI::crGetLastErrorMsg" ref="g062f47d5f7284d72793c60699c7caa33" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_a_p_i.html#g062f47d5f7284d72793c60699c7caa33">crGetLastErrorMsg</a>&nbsp;&nbsp;&nbsp;crGetLastErrorMsgA</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Defines character set-independent mapping for <a class="el" href="group___crash_rpt_a_p_i.html#g5cfc01be2fd1c3daf53f21fa553785ae" title="Gets the last CrashRpt error message.">crGetLastErrorMsgW()</a> and <a class="el" href="group___crash_rpt_a_p_i.html#ga33fe8e2555162c9ed434c4561125ec1">crGetLastErrorMsgA()</a>. <br></td></tr>
<tr><td colspan="2"><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef BOOL(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_a_p_i.html#ga5587485696de27611c497382de06ce3">LPGETLOGFILE</a> )(LPVOID lpvState)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Client crash callback function prototype.  <a href="#ga5587485696de27611c497382de06ce3"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_a_p_i.html#gc1f98f531d9a1c67f090768ce4316ffd">crInstallW</a> (<a class="el" href="struct_c_r___i_n_s_t_a_l_l___i_n_f_o_w.html">PCR_INSTALL_INFOW</a> pInfo)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Installs exception handlers for the caller process.  <a href="#gc1f98f531d9a1c67f090768ce4316ffd"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_a_p_i.html#g18a7a7421e1522f787ba451eaf424b0e">crInstallA</a> (<a class="el" href="struct_c_r___i_n_s_t_a_l_l___i_n_f_o_a.html">PCR_INSTALL_INFOA</a> pInfo)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_a_p_i.html#gb5ff3a104014a1e138878a1882822442">crUninstall</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unsinstalls exception handlers previously installed with <a class="el" href="group___crash_rpt_a_p_i.html#g24acb589d629460590d85735e12b5337" title="Character set-independent mapping of crInstallW() and crInstallA() functions.">crInstall()</a>.  <a href="#gb5ff3a104014a1e138878a1882822442"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_a_p_i.html#g6fe5cff31697f687b29dc73cd34d72b4">crInstallToCurrentThread2</a> (DWORD dwFlags)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Installs exception handlers to the caller thread.  <a href="#g6fe5cff31697f687b29dc73cd34d72b4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_a_p_i.html#gaf56dbee81338534d96ab23f694be43c">crUninstallFromCurrentThread</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Uninstalls C++ exception handlers from the current thread.  <a href="#gaf56dbee81338534d96ab23f694be43c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_a_p_i.html#gc7c157085cda0769968b172ecdd812f2">crAddFile2W</a> (LPCWSTR pszFile, LPCWSTR pszDestFile, LPCWSTR pszDesc, DWORD dwFlags)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adds a file to crash report.  <a href="#gc7c157085cda0769968b172ecdd812f2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_a_p_i.html#gb32d6fda8fbea44b55fd4dd78a54cf47">crAddFile2A</a> (LPCSTR pszFile, LPCSTR pszDestFile, LPCSTR pszDesc, DWORD dwFlags)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_a_p_i.html#g7a2a09a4be002f99d1f224e5a5baae82">crAddScreenshot</a> (DWORD dwFlags)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adds a screenshot to the crash report.  <a href="#g7a2a09a4be002f99d1f224e5a5baae82"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_a_p_i.html#g255c2086d4b4b22ebec30428a067419c">crAddScreenshot2</a> (DWORD dwFlags, int nJpegQuality)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adds a screenshot to the crash report.  <a href="#g255c2086d4b4b22ebec30428a067419c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_a_p_i.html#g07229bda698ce870ee8fef189073967f">crAddPropertyW</a> (LPCWSTR pszPropName, LPCWSTR pszPropValue)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adds a string property to the crash report.  <a href="#g07229bda698ce870ee8fef189073967f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_a_p_i.html#gf46fc13586e64bae226a033499c8979f">crAddPropertyA</a> (LPCSTR pszPropName, LPCSTR pszPropValue)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_a_p_i.html#gdeac8208aa4abe735fc966166ffa4073">crAddRegKeyW</a> (LPCWSTR pszRegKey, LPCWSTR pszDstFileName, DWORD dwFlags)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adds a registry key dump to the crash report.  <a href="#gdeac8208aa4abe735fc966166ffa4073"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_a_p_i.html#g11bcc462c7a44dc3a01abffcd037260f">crAddRegKeyA</a> (LPCSTR pszRegKey, LPCSTR pszDstFileName, DWORD dwFlags)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_a_p_i.html#g60af60c28c64a1d3baa11f1220b9c3f4">crGenerateErrorReport</a> (<a class="el" href="struct_c_r___e_x_c_e_p_t_i_o_n___i_n_f_o.html">CR_EXCEPTION_INFO</a> *pExceptionInfo)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Manually generates an errror report.  <a href="#g60af60c28c64a1d3baa11f1220b9c3f4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_a_p_i.html#g71fc93e6828f68f88b80326104489720">crEmulateCrash</a> (unsigned ExceptionType)  throw (...)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Emulates a predefined crash situation.  <a href="#g71fc93e6828f68f88b80326104489720"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_a_p_i.html#g5cfc01be2fd1c3daf53f21fa553785ae">crGetLastErrorMsgW</a> (LPWSTR pszBuffer, UINT uBuffSize)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets the last CrashRpt error message.  <a href="#g5cfc01be2fd1c3daf53f21fa553785ae"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_a_p_i.html#ga33fe8e2555162c9ed434c4561125ec1">crGetLastErrorMsgA</a> (LPSTR pszBuffer, UINT uBuffSize)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="ga5587485696de27611c497382de06ce3"></a><!-- doxytag: member="CrashRpt.h::LPGETLOGFILE" ref="ga5587485696de27611c497382de06ce3" args=")(LPVOID lpvState)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef BOOL( * <a class="el" href="group___crash_rpt_a_p_i.html#ga5587485696de27611c497382de06ce3">LPGETLOGFILE</a>)(LPVOID lpvState)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Client crash callback function prototype. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>lpvState</em>&nbsp;</td><td>Currently not used, equals to NULL.</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
The crash callback function is called when crash occurs. This way client application is notified about the crash.<p>
It is generally unsafe to do complex actions (e.g. memory allocation, heap operations) inside of this callback. The application state may be unstable.<p>
One reason the application may use this callback for is to close handles to open log files that the application plans to include into the error report. Log files should be accessible for reading, otherwise CrashRpt won't be able to include them into error report.<p>
The crash callback function should typically return <code>TRUE</code> to allow generate error report. Returning <code>FALSE</code> will prevent crash report generation.<p>
The following example shows how to use the crash callback function.<p>
<div class="fragment"><pre class="fragment">  <span class="comment">// define the crash callback</span>
  BOOL CALLBACK CrashCallback(LPVOID lpvState)
  {    
    <span class="comment">// Do something...</span>

    <span class="keywordflow">return</span> TRUE;
  }
</pre></div><p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group___crash_rpt_a_p_i.html#g382c00cf76818ba1a66eb89715a030ea" title="Character set-independent mapping of crAddFile2W() and crAddFile2A() functions.">crAddFile2()</a> </dd></dl>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="gb32d6fda8fbea44b55fd4dd78a54cf47"></a><!-- doxytag: member="CrashRpt.h::crAddFile2A" ref="gb32d6fda8fbea44b55fd4dd78a54cf47" args="(LPCSTR pszFile, LPCSTR pszDestFile, LPCSTR pszDesc, DWORD dwFlags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crAddFile2A           </td>
          <td>(</td>
          <td class="paramtype">LPCSTR&nbsp;</td>
          <td class="paramname"> <em>pszFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCSTR&nbsp;</td>
          <td class="paramname"> <em>pszDestFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCSTR&nbsp;</td>
          <td class="paramname"> <em>pszDesc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DWORD&nbsp;</td>
          <td class="paramname"> <em>dwFlags</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Adds a file to crash report. <p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>This function returns zero if succeeded.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszFile</em>&nbsp;</td><td>Absolute path to the file to add, required. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszDestFile</em>&nbsp;</td><td>Destination file name, optional. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszDesc</em>&nbsp;</td><td>File description (used in Error Report Details dialog), optional. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dwFlags</em>&nbsp;</td><td>Flags, optional.</td></tr>
  </table>
</dl>
This function can be called anytime after <a class="el" href="group___crash_rpt_a_p_i.html#g24acb589d629460590d85735e12b5337" title="Character set-independent mapping of crInstallW() and crInstallA() functions.">crInstall()</a> to add one or more files to the generated crash report.<p>
When this function is called, the file is marked to be added to the error report, then the function returns control to the caller. When crash occurs, all marked files are added to the report by the <b>CrashSender.exe</b> process. If a file is locked by someone for exclusive access, the file won't be included. Inside of <a class="el" href="group___crash_rpt_a_p_i.html#ga5587485696de27611c497382de06ce3">LPGETLOGFILE</a> crash callback, close open file handles and ensure files to be included are acessible for reading.<p>
<em>pszFile</em> should be a valid absolute path of a file to add to crash report.<p>
<em>pszDestFile</em> should be the name of destination file. This parameter can be used to specify different file name for the file in ZIP archive. If this parameter is NULL, the pszFile file name is used as destination file name.<p>
<em>pszDesc</em> is a literal description of a file. It can be NULL.<p>
<em>dwFlags</em> parameter defines the behavior of the function. This can be a combination of the following flags:<ul>
<li><a class="el" href="_crash_rpt_8h.html#8616695331fc9d9b18ac180d35c21166">CR_AF_TAKE_ORIGINAL_FILE</a> On crash, the <b>CrashSender.exe</b> will try to locate the file from its original location. This behavior is the default one.</li><li><a class="el" href="_crash_rpt_8h.html#e365a56cd807acedceff109c06782bdc">CR_AF_MAKE_FILE_COPY</a> On crash, the <b>CrashSender.exe</b> will make a copy of the file and save it to the error report folder.</li></ul>
<p>
<ul>
<li><a class="el" href="_crash_rpt_8h.html#6cc402a796d855aa44f261557d78e18d">CR_AF_FILE_MUST_EXIST</a> The function will fail if file doesn't exist at the moment of function call (the default behavior).</li><li><a class="el" href="_crash_rpt_8h.html#1d84037d795b16725b439d55dcc1dc50">CR_AF_MISSING_FILE_OK</a> Do not fail if file is missing (assume it will be created later).</li></ul>
<p>
If you use postponed error report delivery (if you specify <a class="el" href="_crash_rpt_8h.html#1d2fdb48ae4bf477109baf07b29dd26a">CR_INST_SEND_QUEUED_REPORTS</a> flag for <a class="el" href="struct_c_r___i_n_s_t_a_l_l___i_n_f_o_a.html#2ca0180aea2957c6698cd7c63925d33e">CR_INSTALL_INFO::dwFlags</a> structure member) you must also specify the <a class="el" href="_crash_rpt_8h.html#e365a56cd807acedceff109c06782bdc">CR_AF_MAKE_FILE_COPY</a> as <em>dwFlags</em> parameter value. This will guarantee that a snapshot of your file at the moment of crash is taken and saved to the error report folder.<p>
This function fails if <em>pszFile</em> doesn't exist at the moment of function call, unless you specify <a class="el" href="_crash_rpt_8h.html#1d84037d795b16725b439d55dcc1dc50">CR_AF_MISSING_FILE_OK</a> flag.<p>
The <a class="el" href="group___crash_rpt_a_p_i.html#gc7c157085cda0769968b172ecdd812f2" title="Adds a file to crash report.">crAddFile2W()</a> and <a class="el" href="group___crash_rpt_a_p_i.html#gb32d6fda8fbea44b55fd4dd78a54cf47">crAddFile2A()</a> are wide-character and multibyte-character versions of <a class="el" href="group___crash_rpt_a_p_i.html#g382c00cf76818ba1a66eb89715a030ea" title="Character set-independent mapping of crAddFile2W() and crAddFile2A() functions.">crAddFile2()</a> function. The <a class="el" href="group___crash_rpt_a_p_i.html#g382c00cf76818ba1a66eb89715a030ea" title="Character set-independent mapping of crAddFile2W() and crAddFile2A() functions.">crAddFile2()</a> macro defines character set independent mapping.<p>
This function is available <b>since v.1.2.1</b>. This function replaces the <a class="el" href="group___deprecated_a_p_i.html#g7bb0d6cebaf9c3aa3aae05d0412b6176" title="Character set-independent mapping of crAddFileW() and crAddFileA() functions.">crAddFile()</a> function.<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group___crash_rpt_a_p_i.html#gc7c157085cda0769968b172ecdd812f2" title="Adds a file to crash report.">crAddFile2W()</a>, <a class="el" href="group___crash_rpt_a_p_i.html#gb32d6fda8fbea44b55fd4dd78a54cf47">crAddFile2A()</a>, <a class="el" href="group___crash_rpt_a_p_i.html#g382c00cf76818ba1a66eb89715a030ea" title="Character set-independent mapping of crAddFile2W() and crAddFile2A() functions.">crAddFile2()</a> </dd></dl>
 
</div>
</div><p>
<a class="anchor" name="gc7c157085cda0769968b172ecdd812f2"></a><!-- doxytag: member="CrashRpt.h::crAddFile2W" ref="gc7c157085cda0769968b172ecdd812f2" args="(LPCWSTR pszFile, LPCWSTR pszDestFile, LPCWSTR pszDesc, DWORD dwFlags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crAddFile2W           </td>
          <td>(</td>
          <td class="paramtype">LPCWSTR&nbsp;</td>
          <td class="paramname"> <em>pszFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCWSTR&nbsp;</td>
          <td class="paramname"> <em>pszDestFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCWSTR&nbsp;</td>
          <td class="paramname"> <em>pszDesc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DWORD&nbsp;</td>
          <td class="paramname"> <em>dwFlags</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Adds a file to crash report. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>This function returns zero if succeeded.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszFile</em>&nbsp;</td><td>Absolute path to the file to add, required. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszDestFile</em>&nbsp;</td><td>Destination file name, optional. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszDesc</em>&nbsp;</td><td>File description (used in Error Report Details dialog), optional. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dwFlags</em>&nbsp;</td><td>Flags, optional.</td></tr>
  </table>
</dl>
This function can be called anytime after <a class="el" href="group___crash_rpt_a_p_i.html#g24acb589d629460590d85735e12b5337" title="Character set-independent mapping of crInstallW() and crInstallA() functions.">crInstall()</a> to add one or more files to the generated crash report.<p>
When this function is called, the file is marked to be added to the error report, then the function returns control to the caller. When crash occurs, all marked files are added to the report by the <b>CrashSender.exe</b> process. If a file is locked by someone for exclusive access, the file won't be included. Inside of <a class="el" href="group___crash_rpt_a_p_i.html#ga5587485696de27611c497382de06ce3">LPGETLOGFILE</a> crash callback, close open file handles and ensure files to be included are acessible for reading.<p>
<em>pszFile</em> should be a valid absolute path of a file to add to crash report.<p>
<em>pszDestFile</em> should be the name of destination file. This parameter can be used to specify different file name for the file in ZIP archive. If this parameter is NULL, the pszFile file name is used as destination file name.<p>
<em>pszDesc</em> is a literal description of a file. It can be NULL.<p>
<em>dwFlags</em> parameter defines the behavior of the function. This can be a combination of the following flags:<ul>
<li><a class="el" href="_crash_rpt_8h.html#8616695331fc9d9b18ac180d35c21166">CR_AF_TAKE_ORIGINAL_FILE</a> On crash, the <b>CrashSender.exe</b> will try to locate the file from its original location. This behavior is the default one.</li><li><a class="el" href="_crash_rpt_8h.html#e365a56cd807acedceff109c06782bdc">CR_AF_MAKE_FILE_COPY</a> On crash, the <b>CrashSender.exe</b> will make a copy of the file and save it to the error report folder.</li></ul>
<p>
<ul>
<li><a class="el" href="_crash_rpt_8h.html#6cc402a796d855aa44f261557d78e18d">CR_AF_FILE_MUST_EXIST</a> The function will fail if file doesn't exist at the moment of function call (the default behavior).</li><li><a class="el" href="_crash_rpt_8h.html#1d84037d795b16725b439d55dcc1dc50">CR_AF_MISSING_FILE_OK</a> Do not fail if file is missing (assume it will be created later).</li></ul>
<p>
If you use postponed error report delivery (if you specify <a class="el" href="_crash_rpt_8h.html#1d2fdb48ae4bf477109baf07b29dd26a">CR_INST_SEND_QUEUED_REPORTS</a> flag for <a class="el" href="struct_c_r___i_n_s_t_a_l_l___i_n_f_o_a.html#2ca0180aea2957c6698cd7c63925d33e">CR_INSTALL_INFO::dwFlags</a> structure member) you must also specify the <a class="el" href="_crash_rpt_8h.html#e365a56cd807acedceff109c06782bdc">CR_AF_MAKE_FILE_COPY</a> as <em>dwFlags</em> parameter value. This will guarantee that a snapshot of your file at the moment of crash is taken and saved to the error report folder.<p>
This function fails if <em>pszFile</em> doesn't exist at the moment of function call, unless you specify <a class="el" href="_crash_rpt_8h.html#1d84037d795b16725b439d55dcc1dc50">CR_AF_MISSING_FILE_OK</a> flag.<p>
The <a class="el" href="group___crash_rpt_a_p_i.html#gc7c157085cda0769968b172ecdd812f2" title="Adds a file to crash report.">crAddFile2W()</a> and <a class="el" href="group___crash_rpt_a_p_i.html#gb32d6fda8fbea44b55fd4dd78a54cf47">crAddFile2A()</a> are wide-character and multibyte-character versions of <a class="el" href="group___crash_rpt_a_p_i.html#g382c00cf76818ba1a66eb89715a030ea" title="Character set-independent mapping of crAddFile2W() and crAddFile2A() functions.">crAddFile2()</a> function. The <a class="el" href="group___crash_rpt_a_p_i.html#g382c00cf76818ba1a66eb89715a030ea" title="Character set-independent mapping of crAddFile2W() and crAddFile2A() functions.">crAddFile2()</a> macro defines character set independent mapping.<p>
This function is available <b>since v.1.2.1</b>. This function replaces the <a class="el" href="group___deprecated_a_p_i.html#g7bb0d6cebaf9c3aa3aae05d0412b6176" title="Character set-independent mapping of crAddFileW() and crAddFileA() functions.">crAddFile()</a> function.<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group___crash_rpt_a_p_i.html#gc7c157085cda0769968b172ecdd812f2" title="Adds a file to crash report.">crAddFile2W()</a>, <a class="el" href="group___crash_rpt_a_p_i.html#gb32d6fda8fbea44b55fd4dd78a54cf47">crAddFile2A()</a>, <a class="el" href="group___crash_rpt_a_p_i.html#g382c00cf76818ba1a66eb89715a030ea" title="Character set-independent mapping of crAddFile2W() and crAddFile2A() functions.">crAddFile2()</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="gf46fc13586e64bae226a033499c8979f"></a><!-- doxytag: member="CrashRpt.h::crAddPropertyA" ref="gf46fc13586e64bae226a033499c8979f" args="(LPCSTR pszPropName, LPCSTR pszPropValue)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crAddPropertyA           </td>
          <td>(</td>
          <td class="paramtype">LPCSTR&nbsp;</td>
          <td class="paramname"> <em>pszPropName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCSTR&nbsp;</td>
          <td class="paramname"> <em>pszPropValue</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Adds a string property to the crash report. <p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>This function returns zero if succeeded. Use <a class="el" href="group___crash_rpt_a_p_i.html#g062f47d5f7284d72793c60699c7caa33" title="Defines character set-independent mapping for crGetLastErrorMsgW() and crGetLastErrorMsgA()...">crGetLastErrorMsg()</a> to retrieve the error message on fail.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszPropName</em>&nbsp;</td><td>Name of the property, required. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszPropValue</em>&nbsp;</td><td>Value of the property, required.</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
Use this function to add a string property to the crash description XML file. User-added properties are listed under &lt;CustomProps&gt; tag of the XML file.<p>
The following example shows how to add information about the amount of free disk space to the crash description XML file: <div class="fragment"><pre class="fragment">  <span class="comment">// It is assumed that you already calculated the amount of free disk space, converted it to text</span>
  <span class="comment">// and store it as szFreeSpace string.</span>
  LPCTSTR szFreeSpace = _T(<span class="stringliteral">"0 Kb"</span>);
  <a class="code" href="group___crash_rpt_a_p_i.html#g5bc9d5a06b3ef1bb62e61b109f890730" title="Character set-independent mapping of crAddPropertyW() and crAddPropertyA() functions...">crAddProperty</a>(_T(<span class="stringliteral">"FreeDiskSpace"</span>), szFreeSpace);
</pre></div><p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group___crash_rpt_a_p_i.html#g382c00cf76818ba1a66eb89715a030ea" title="Character set-independent mapping of crAddFile2W() and crAddFile2A() functions.">crAddFile2()</a>, <a class="el" href="group___crash_rpt_a_p_i.html#g7a2a09a4be002f99d1f224e5a5baae82" title="Adds a screenshot to the crash report.">crAddScreenshot()</a> </dd></dl>
 
</div>
</div><p>
<a class="anchor" name="g07229bda698ce870ee8fef189073967f"></a><!-- doxytag: member="CrashRpt.h::crAddPropertyW" ref="g07229bda698ce870ee8fef189073967f" args="(LPCWSTR pszPropName, LPCWSTR pszPropValue)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crAddPropertyW           </td>
          <td>(</td>
          <td class="paramtype">LPCWSTR&nbsp;</td>
          <td class="paramname"> <em>pszPropName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCWSTR&nbsp;</td>
          <td class="paramname"> <em>pszPropValue</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Adds a string property to the crash report. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>This function returns zero if succeeded. Use <a class="el" href="group___crash_rpt_a_p_i.html#g062f47d5f7284d72793c60699c7caa33" title="Defines character set-independent mapping for crGetLastErrorMsgW() and crGetLastErrorMsgA()...">crGetLastErrorMsg()</a> to retrieve the error message on fail.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszPropName</em>&nbsp;</td><td>Name of the property, required. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszPropValue</em>&nbsp;</td><td>Value of the property, required.</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
Use this function to add a string property to the crash description XML file. User-added properties are listed under &lt;CustomProps&gt; tag of the XML file.<p>
The following example shows how to add information about the amount of free disk space to the crash description XML file: <div class="fragment"><pre class="fragment">  <span class="comment">// It is assumed that you already calculated the amount of free disk space, converted it to text</span>
  <span class="comment">// and store it as szFreeSpace string.</span>
  LPCTSTR szFreeSpace = _T(<span class="stringliteral">"0 Kb"</span>);
  <a class="code" href="group___crash_rpt_a_p_i.html#g5bc9d5a06b3ef1bb62e61b109f890730" title="Character set-independent mapping of crAddPropertyW() and crAddPropertyA() functions...">crAddProperty</a>(_T(<span class="stringliteral">"FreeDiskSpace"</span>), szFreeSpace);
</pre></div><p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group___crash_rpt_a_p_i.html#g382c00cf76818ba1a66eb89715a030ea" title="Character set-independent mapping of crAddFile2W() and crAddFile2A() functions.">crAddFile2()</a>, <a class="el" href="group___crash_rpt_a_p_i.html#g7a2a09a4be002f99d1f224e5a5baae82" title="Adds a screenshot to the crash report.">crAddScreenshot()</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="g11bcc462c7a44dc3a01abffcd037260f"></a><!-- doxytag: member="CrashRpt.h::crAddRegKeyA" ref="g11bcc462c7a44dc3a01abffcd037260f" args="(LPCSTR pszRegKey, LPCSTR pszDstFileName, DWORD dwFlags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crAddRegKeyA           </td>
          <td>(</td>
          <td class="paramtype">LPCSTR&nbsp;</td>
          <td class="paramname"> <em>pszRegKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCSTR&nbsp;</td>
          <td class="paramname"> <em>pszDstFileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DWORD&nbsp;</td>
          <td class="paramname"> <em>dwFlags</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Adds a registry key dump to the crash report. <p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>This function returns zero if succeeded. Use <a class="el" href="group___crash_rpt_a_p_i.html#g062f47d5f7284d72793c60699c7caa33" title="Defines character set-independent mapping for crGetLastErrorMsgW() and crGetLastErrorMsgA()...">crGetLastErrorMsg()</a> to retrieve the error message on fail.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszRegKey</em>&nbsp;</td><td>Registry key to dump, required. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszDstFileName</em>&nbsp;</td><td>Name of the destination file, required. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dwFlags</em>&nbsp;</td><td>Flags, reserved.</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
Use this function to add a dump of a Windows registry key into the crash report. This function is available since v.1.2.6.<p>
The <em>pszRegKey</em> parameter must be the name of the registry key. The key name should begin with "HKEY_CURRENT_USER" or "HKEY_LOCAL_MACHINE". Other root keys are not supported.<p>
The content of the key specified by the <em>pszRegKey</em> parameter will be stored in a human-readable XML format and included into the error report as <em>pszDstFileName</em> destination file. You can dump multiple registry keys to the same destination file.<p>
The <em>dwFlags</em> parameter is reserved for future use and should be set to zero.<p>
The following example shows how to dump two registry keys to <b>regkey.xml</b> file:<p>
<div class="fragment"><pre class="fragment">  <a class="code" href="group___crash_rpt_a_p_i.html#ge5c00c702ef3b674f9c4a509f61728e1" title="Character set-independent mapping of crAddRegKeyW() and crAddRegKeyA() functions...">crAddRegKey</a>(_T(<span class="stringliteral">"HKEY_CURRENT_USER\\Software\\MyApp"</span>), _T(<span class="stringliteral">"regkey.xml"</span>), 0);
  <a class="code" href="group___crash_rpt_a_p_i.html#ge5c00c702ef3b674f9c4a509f61728e1" title="Character set-independent mapping of crAddRegKeyW() and crAddRegKeyA() functions...">crAddRegKey</a>(_T(<span class="stringliteral">"HKEY_LOCAL_MACHINE\\Software\\MyApp"</span>), _T(<span class="stringliteral">"regkey.xml"</span>), 0);
</pre></div><p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group___crash_rpt_a_p_i.html#g382c00cf76818ba1a66eb89715a030ea" title="Character set-independent mapping of crAddFile2W() and crAddFile2A() functions.">crAddFile2()</a>, <a class="el" href="group___crash_rpt_a_p_i.html#g7a2a09a4be002f99d1f224e5a5baae82" title="Adds a screenshot to the crash report.">crAddScreenshot()</a>, <a class="el" href="group___crash_rpt_a_p_i.html#g5bc9d5a06b3ef1bb62e61b109f890730" title="Character set-independent mapping of crAddPropertyW() and crAddPropertyA() functions...">crAddProperty()</a> </dd></dl>
 
</div>
</div><p>
<a class="anchor" name="gdeac8208aa4abe735fc966166ffa4073"></a><!-- doxytag: member="CrashRpt.h::crAddRegKeyW" ref="gdeac8208aa4abe735fc966166ffa4073" args="(LPCWSTR pszRegKey, LPCWSTR pszDstFileName, DWORD dwFlags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crAddRegKeyW           </td>
          <td>(</td>
          <td class="paramtype">LPCWSTR&nbsp;</td>
          <td class="paramname"> <em>pszRegKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCWSTR&nbsp;</td>
          <td class="paramname"> <em>pszDstFileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DWORD&nbsp;</td>
          <td class="paramname"> <em>dwFlags</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Adds a registry key dump to the crash report. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>This function returns zero if succeeded. Use <a class="el" href="group___crash_rpt_a_p_i.html#g062f47d5f7284d72793c60699c7caa33" title="Defines character set-independent mapping for crGetLastErrorMsgW() and crGetLastErrorMsgA()...">crGetLastErrorMsg()</a> to retrieve the error message on fail.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszRegKey</em>&nbsp;</td><td>Registry key to dump, required. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszDstFileName</em>&nbsp;</td><td>Name of the destination file, required. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dwFlags</em>&nbsp;</td><td>Flags, reserved.</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
Use this function to add a dump of a Windows registry key into the crash report. This function is available since v.1.2.6.<p>
The <em>pszRegKey</em> parameter must be the name of the registry key. The key name should begin with "HKEY_CURRENT_USER" or "HKEY_LOCAL_MACHINE". Other root keys are not supported.<p>
The content of the key specified by the <em>pszRegKey</em> parameter will be stored in a human-readable XML format and included into the error report as <em>pszDstFileName</em> destination file. You can dump multiple registry keys to the same destination file.<p>
The <em>dwFlags</em> parameter is reserved for future use and should be set to zero.<p>
The following example shows how to dump two registry keys to <b>regkey.xml</b> file:<p>
<div class="fragment"><pre class="fragment">  <a class="code" href="group___crash_rpt_a_p_i.html#ge5c00c702ef3b674f9c4a509f61728e1" title="Character set-independent mapping of crAddRegKeyW() and crAddRegKeyA() functions...">crAddRegKey</a>(_T(<span class="stringliteral">"HKEY_CURRENT_USER\\Software\\MyApp"</span>), _T(<span class="stringliteral">"regkey.xml"</span>), 0);
  <a class="code" href="group___crash_rpt_a_p_i.html#ge5c00c702ef3b674f9c4a509f61728e1" title="Character set-independent mapping of crAddRegKeyW() and crAddRegKeyA() functions...">crAddRegKey</a>(_T(<span class="stringliteral">"HKEY_LOCAL_MACHINE\\Software\\MyApp"</span>), _T(<span class="stringliteral">"regkey.xml"</span>), 0);
</pre></div><p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group___crash_rpt_a_p_i.html#g382c00cf76818ba1a66eb89715a030ea" title="Character set-independent mapping of crAddFile2W() and crAddFile2A() functions.">crAddFile2()</a>, <a class="el" href="group___crash_rpt_a_p_i.html#g7a2a09a4be002f99d1f224e5a5baae82" title="Adds a screenshot to the crash report.">crAddScreenshot()</a>, <a class="el" href="group___crash_rpt_a_p_i.html#g5bc9d5a06b3ef1bb62e61b109f890730" title="Character set-independent mapping of crAddPropertyW() and crAddPropertyA() functions...">crAddProperty()</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="g7a2a09a4be002f99d1f224e5a5baae82"></a><!-- doxytag: member="CrashRpt.h::crAddScreenshot" ref="g7a2a09a4be002f99d1f224e5a5baae82" args="(DWORD dwFlags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crAddScreenshot           </td>
          <td>(</td>
          <td class="paramtype">DWORD&nbsp;</td>
          <td class="paramname"> <em>dwFlags</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Adds a screenshot to the crash report. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>This function returns zero if succeeded. Use <a class="el" href="group___crash_rpt_a_p_i.html#g062f47d5f7284d72793c60699c7caa33" title="Defines character set-independent mapping for crGetLastErrorMsgW() and crGetLastErrorMsgA()...">crGetLastErrorMsg()</a> to retrieve the error message on fail.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dwFlags</em>&nbsp;</td><td>Flags, optional.</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
This function can be used to take a screenshot at the moment of crash and add it to the error report. Screenshot information may help the developer to better understand the state of the application at the moment of crash and reproduce the error.<p>
When this function is called, screenshot flags are saved, then the function returns control to the caller. When crash occurs, screenshot is made by the <b>CrashSender.exe</b> process and added to the report.<p>
<b>dwFlags</b> <p>
Use one of the following constants to specify what part of virtual screen to capture:<ul>
<li><a class="el" href="_crash_rpt_8h.html#5d0f686c9cbb88bdc7425ab3b8bf7d1a">CR_AS_VIRTUAL_SCREEN</a> Use this to take a screenshot of the whole desktop (virtual screen).</li><li><a class="el" href="_crash_rpt_8h.html#b93f74b002581555dc2011e934d79077">CR_AS_MAIN_WINDOW</a> Use this to take a screenshot of the application's main window.</li><li><a class="el" href="_crash_rpt_8h.html#abfcf8b70b29d12bbd6b67654227de19">CR_AS_PROCESS_WINDOWS</a> Use this to take a screenshot of all visible windows that belong to the process.</li></ul>
<p>
The main application window is a window that has a caption (<b>WS_CAPTION</b>), system menu (<b>WS_SYSMENU</b>) and the <b>WS_EX_APPWINDOW</b> extended style. If CrashRpt doesn't find such window, it considers the first found process window as the main window.<p>
Screenshots are added in form of PNG files by default. You can specify the <a class="el" href="_crash_rpt_8h.html#166b110421e56bfad02f0b727a652815">CR_AS_USE_JPEG_FORMAT</a> flag to save screenshots as JPEG files instead.<p>
In addition, you can specify the <a class="el" href="_crash_rpt_8h.html#9bbc5d1376e55b96903e53de6f0e3d71">CR_AS_GRAYSCALE_IMAGE</a> flag to make a grayscale screenshot (by default color image is made). Grayscale image gives smaller file size.<p>
If you use JPEG image format, you may better use the <a class="el" href="group___crash_rpt_a_p_i.html#g255c2086d4b4b22ebec30428a067419c">crAddScreenshot2()</a> function, that allows to define JPEG image quality.<p>
When capturing entire desktop consisting of several monitors, one screenshot file is added per each monitor.<p>
You should be careful when using this feature, because screenshots may contain user-identifying or private information. Always specify purposes you will use collected information for in your Privacy Policy.<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group___crash_rpt_a_p_i.html#g382c00cf76818ba1a66eb89715a030ea" title="Character set-independent mapping of crAddFile2W() and crAddFile2A() functions.">crAddFile2()</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="g255c2086d4b4b22ebec30428a067419c"></a><!-- doxytag: member="CrashRpt.h::crAddScreenshot2" ref="g255c2086d4b4b22ebec30428a067419c" args="(DWORD dwFlags, int nJpegQuality)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crAddScreenshot2           </td>
          <td>(</td>
          <td class="paramtype">DWORD&nbsp;</td>
          <td class="paramname"> <em>dwFlags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nJpegQuality</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Adds a screenshot to the crash report. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>This function returns zero if succeeded. Use <a class="el" href="group___crash_rpt_a_p_i.html#g062f47d5f7284d72793c60699c7caa33" title="Defines character set-independent mapping for crGetLastErrorMsgW() and crGetLastErrorMsgA()...">crGetLastErrorMsg()</a> to retrieve the error message on fail.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dwFlags</em>&nbsp;</td><td>Flags, optional. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>nJpegQuality</em>&nbsp;</td><td>Defines the JPEG image quality, optional.</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
This function can be used to take a screenshot at the moment of crash and add it to the error report. Screenshot information may help the developer to better understand state of the application at the moment of crash and reproduce the error.<p>
When this function is called, screenshot flags are saved, then the function returns control to the caller. When crash occurs, screenshot is made by the <b>CrashSender.exe</b> process and added to the report.<p>
<b>dwFlags</b> <p>
Use one of the following constants to specify what part of virtual screen to capture:<ul>
<li><a class="el" href="_crash_rpt_8h.html#5d0f686c9cbb88bdc7425ab3b8bf7d1a">CR_AS_VIRTUAL_SCREEN</a> Use this to take a screenshot of the whole desktop (virtual screen).</li><li><a class="el" href="_crash_rpt_8h.html#b93f74b002581555dc2011e934d79077">CR_AS_MAIN_WINDOW</a> Use this to take a screenshot of the main application main window.</li><li><a class="el" href="_crash_rpt_8h.html#abfcf8b70b29d12bbd6b67654227de19">CR_AS_PROCESS_WINDOWS</a> Use this to take a screenshot of all visible windows that belong to the process.</li></ul>
<p>
The main application window is a window that has a caption (<b>WS_CAPTION</b>), system menu (<b>WS_SYSMENU</b>) and the <b>WS_EX_APPWINDOW</b> extended style. If CrashRpt doesn't find such window, it considers the first found process window as the main window.<p>
Screenshots are added in form of PNG files by default. You can specify the <a class="el" href="_crash_rpt_8h.html#166b110421e56bfad02f0b727a652815">CR_AS_USE_JPEG_FORMAT</a> flag to save screenshots as JPEG files instead.<p>
If you use JPEG format, you can use the <em>nJpegQuality</em> parameter to define the JPEG image quality. This should be the number between 0 and 100, inclusively. The bigger the number, the better the quality and the bigger the JPEG file size. If you use PNG file format, this parameter is ignored.<p>
In addition, you can specify the <a class="el" href="_crash_rpt_8h.html#9bbc5d1376e55b96903e53de6f0e3d71">CR_AS_GRAYSCALE_IMAGE</a> flag to make a grayscale screenshot (by default color image is made). Grayscale image gives smaller file size.<p>
When capturing entire desktop consisting of several monitors, one screenshot file is added per each monitor.<p>
You should be careful when using this feature, because screenshots may contain user-identifying or private information. Always specify purposes you will use collected information for in your Privacy Policy.<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group___crash_rpt_a_p_i.html#g382c00cf76818ba1a66eb89715a030ea" title="Character set-independent mapping of crAddFile2W() and crAddFile2A() functions.">crAddFile2()</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="g71fc93e6828f68f88b80326104489720"></a><!-- doxytag: member="CrashRpt.h::crEmulateCrash" ref="g71fc93e6828f68f88b80326104489720" args="(unsigned ExceptionType)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crEmulateCrash           </td>
          <td>(</td>
          <td class="paramtype">unsigned&nbsp;</td>
          <td class="paramname"> <em>ExceptionType</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td>  throw (...)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Emulates a predefined crash situation. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>This function doesn't return if succeded. If failed, returns non-zero value. Call <a class="el" href="group___crash_rpt_a_p_i.html#g062f47d5f7284d72793c60699c7caa33" title="Defines character set-independent mapping for crGetLastErrorMsgW() and crGetLastErrorMsgA()...">crGetLastErrorMsg()</a> to get the last error message.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ExceptionType</em>&nbsp;</td><td>Type of crash.</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
This function uses some a priori incorrect or vulnerable code or raises a C++ signal or raises an uncontinuable software exception to cause crash.<p>
This function can be used to test if CrashRpt handles a crash situation correctly.<p>
CrashRpt will intercept an error or exception if <a class="el" href="group___crash_rpt_a_p_i.html#g24acb589d629460590d85735e12b5337" title="Character set-independent mapping of crInstallW() and crInstallA() functions.">crInstall()</a> and/or <a class="el" href="group___crash_rpt_a_p_i.html#g6fe5cff31697f687b29dc73cd34d72b4" title="Installs exception handlers to the caller thread.">crInstallToCurrentThread2()</a> were previously called. <a class="el" href="group___crash_rpt_a_p_i.html#g24acb589d629460590d85735e12b5337" title="Character set-independent mapping of crInstallW() and crInstallA() functions.">crInstall()</a> installs exception handlers that function on per-process basis. <a class="el" href="group___crash_rpt_a_p_i.html#g6fe5cff31697f687b29dc73cd34d72b4" title="Installs exception handlers to the caller thread.">crInstallToCurrentThread2()</a> installs exception handlers that function on per-thread basis.<p>
<em>ExceptionType</em> can be one of the following constants:<ul>
<li><a class="el" href="_crash_rpt_8h.html#f7d99ba0fa3da687cbfdbeacac24ea42">CR_SEH_EXCEPTION</a> This will generate a null pointer exception.</li><li><a class="el" href="_crash_rpt_8h.html#f4aa23b38193070ef4b38f1b3a8a0963">CR_CPP_TERMINATE_CALL</a> This results in call of terminate() C++ function.</li><li><a class="el" href="_crash_rpt_8h.html#425fc28f72ebc3e44699017af3604f02">CR_CPP_UNEXPECTED_CALL</a> This results in call of unexpected() C++ function.</li><li><a class="el" href="_crash_rpt_8h.html#8b310cb7b13b52bcd990b08ea4064656">CR_CPP_PURE_CALL</a> This emulates a call of pure virtual method call of a C++ class instance (Visual Studio .NET 2003 and later).</li><li><a class="el" href="_crash_rpt_8h.html#8cb24472b56c470d06f83de63ca8ccd4">CR_CPP_NEW_OPERATOR_ERROR</a> This emulates C++ new operator failure (Visual Studio .NET 2003 and later).</li><li><a class="el" href="_crash_rpt_8h.html#acfd8849a933d5cb10cef847cda1f57e">CR_CPP_SECURITY_ERROR</a> This emulates copy of large amount of data to a small buffer (Visual Studio .NET 2003 only).</li><li><a class="el" href="_crash_rpt_8h.html#289276fc38581e2adbd6508c7280f98c">CR_CPP_INVALID_PARAMETER</a> This emulates an invalid parameter C++ exception (Visual Studio 2005 and later).</li><li><a class="el" href="_crash_rpt_8h.html#4a9676354f749187eb7daf13e1010a87">CR_CPP_SIGABRT</a> This raises SIGABRT signal (abnormal program termination).</li><li><a class="el" href="_crash_rpt_8h.html#ba15c588b5f86a80a08981c1f72b40a9">CR_CPP_SIGFPE</a> This causes floating point exception.</li><li><a class="el" href="_crash_rpt_8h.html#e390276b0945e085829a8b40b1994d08">CR_CPP_SIGILL</a> This raises SIGILL signal (illegal instruction signal).</li><li><a class="el" href="_crash_rpt_8h.html#05e11a23bf8e0a5b7cea27b9849e27e0">CR_CPP_SIGINT</a> This raises SIGINT signal.</li><li><a class="el" href="_crash_rpt_8h.html#99a0bc97f2f36f507b837d9ad9091d37">CR_CPP_SIGSEGV</a> This raises SIGSEGV signal.</li><li><a class="el" href="_crash_rpt_8h.html#79e36c7aca1e27eeb4d95a2ccab94809">CR_CPP_SIGTERM</a> This raises SIGTERM signal (program termination request).</li><li><a class="el" href="_crash_rpt_8h.html#70dfcb27bf9d3888a6036c5ca040f8a7">CR_NONCONTINUABLE_EXCEPTION</a> This raises a noncontinuable software exception (expected result is the same as in <a class="el" href="_crash_rpt_8h.html#f7d99ba0fa3da687cbfdbeacac24ea42">CR_SEH_EXCEPTION</a>).</li><li><a class="el" href="_crash_rpt_8h.html#45c213196f9d310715f13cd38e8be089">CR_THROW</a> This throws a C++ typed exception (expected result is the same as in <a class="el" href="_crash_rpt_8h.html#f4aa23b38193070ef4b38f1b3a8a0963">CR_CPP_TERMINATE_CALL</a>).</li></ul>
<p>
The <a class="el" href="_crash_rpt_8h.html#f7d99ba0fa3da687cbfdbeacac24ea42">CR_SEH_EXCEPTION</a> uses null pointer write operation to cause the access violation.<p>
The <a class="el" href="_crash_rpt_8h.html#70dfcb27bf9d3888a6036c5ca040f8a7">CR_NONCONTINUABLE_EXCEPTION</a> has the same effect as <a class="el" href="_crash_rpt_8h.html#f7d99ba0fa3da687cbfdbeacac24ea42">CR_SEH_EXCEPTION</a>, but it uses <b>RaiseException()</b> WinAPI function to raise noncontinuable software exception.<p>
The following example shows how to use <a class="el" href="group___crash_rpt_a_p_i.html#g71fc93e6828f68f88b80326104489720" title="Emulates a predefined crash situation.">crEmulateCrash()</a> function.<p>
<div class="fragment"><pre class="fragment">  <span class="comment">// emulate null pointer exception (access violation)</span>
  <a class="code" href="group___crash_rpt_a_p_i.html#g71fc93e6828f68f88b80326104489720" title="Emulates a predefined crash situation.">crEmulateCrash</a>(<a class="code" href="_crash_rpt_8h.html#f7d99ba0fa3da687cbfdbeacac24ea42" title="SEH exception.">CR_SEH_EXCEPTION</a>);
</pre></div> 
</div>
</div><p>
<a class="anchor" name="g60af60c28c64a1d3baa11f1220b9c3f4"></a><!-- doxytag: member="CrashRpt.h::crGenerateErrorReport" ref="g60af60c28c64a1d3baa11f1220b9c3f4" args="(CR_EXCEPTION_INFO *pExceptionInfo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crGenerateErrorReport           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_c_r___e_x_c_e_p_t_i_o_n___i_n_f_o.html">CR_EXCEPTION_INFO</a> *&nbsp;</td>
          <td class="paramname"> <em>pExceptionInfo</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Manually generates an errror report. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>This function returns zero if succeeded. When failed, it returns a non-zero value. Use <a class="el" href="group___crash_rpt_a_p_i.html#g062f47d5f7284d72793c60699c7caa33" title="Defines character set-independent mapping for crGetLastErrorMsgW() and crGetLastErrorMsgA()...">crGetLastErrorMsg()</a> to retrieve the error message.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pExceptionInfo</em>&nbsp;</td><td>Exception information.</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
Call this function to manually generate a crash report. When crash information is collected, control is returned to the caller. The <a class="el" href="group___crash_rpt_a_p_i.html#g60af60c28c64a1d3baa11f1220b9c3f4" title="Manually generates an errror report.">crGenerateErrorReport()</a> doesn't terminate the caller process.<p>
The crash report contains crash minidump, crash description in XML format and additional custom files added with <a class="el" href="group___crash_rpt_a_p_i.html#g382c00cf76818ba1a66eb89715a030ea" title="Character set-independent mapping of crAddFile2W() and crAddFile2A() functions.">crAddFile2()</a>.<p>
The exception information should be passed using <a class="el" href="struct_c_r___e_x_c_e_p_t_i_o_n___i_n_f_o.html">CR_EXCEPTION_INFO</a> structure.<p>
The following example shows how to use <a class="el" href="group___crash_rpt_a_p_i.html#g60af60c28c64a1d3baa11f1220b9c3f4" title="Manually generates an errror report.">crGenerateErrorReport()</a> function.<p>
<div class="fragment"><pre class="fragment">    <a class="code" href="struct_c_r___e_x_c_e_p_t_i_o_n___i_n_f_o.html">CR_EXCEPTION_INFO</a> ei;
    memset(&amp;ei, 0, <span class="keyword">sizeof</span>(<a class="code" href="struct_c_r___e_x_c_e_p_t_i_o_n___i_n_f_o.html">CR_EXCEPTION_INFO</a>));
    ei.<a class="code" href="struct_c_r___e_x_c_e_p_t_i_o_n___i_n_f_o.html#b86afdd7b391d5a2fd766e49e67975b1" title="Size of this structure in bytes; should be initialized before using.">cb</a> = <span class="keyword">sizeof</span>(<a class="code" href="struct_c_r___e_x_c_e_p_t_i_o_n___i_n_f_o.html">CR_EXCEPTION_INFO</a>);
    ei.<a class="code" href="struct_c_r___e_x_c_e_p_t_i_o_n___i_n_f_o.html#62f2005b4508289497a10c0e3e96b1be" title="Exception type.">exctype</a> = <a class="code" href="_crash_rpt_8h.html#f7d99ba0fa3da687cbfdbeacac24ea42" title="SEH exception.">CR_SEH_EXCEPTION</a>;
    ei.<a class="code" href="struct_c_r___e_x_c_e_p_t_i_o_n___i_n_f_o.html#e2398087ef570faf683a6abd7ea0b594" title="Code of SEH exception.">code</a> = 1234;
    ei.<a class="code" href="struct_c_r___e_x_c_e_p_t_i_o_n___i_n_f_o.html#3de8fb114330a29c02d177e6ca37910c" title="Exception pointers.">pexcptrs</a> = NULL;

    <span class="keywordtype">int</span> result = <a class="code" href="group___crash_rpt_a_p_i.html#g60af60c28c64a1d3baa11f1220b9c3f4" title="Manually generates an errror report.">crGenerateErrorReport</a>(&amp;ei);

    <span class="keywordflow">if</span>(result!=0)
    {
      <span class="comment">// If goes here, crGenerateErrorReport() has failed</span>
      <span class="comment">// Get the last error message</span>
      TCHAR szErrorMsg[256];
      <a class="code" href="group___crash_rpt_a_p_i.html#g062f47d5f7284d72793c60699c7caa33" title="Defines character set-independent mapping for crGetLastErrorMsgW() and crGetLastErrorMsgA()...">crGetLastErrorMsg</a>(szErrorMsg, 256);
    }
   
    <span class="comment">// Manually terminate program</span>
    ExitProcess(0);
</pre></div> 
</div>
</div><p>
<a class="anchor" name="ga33fe8e2555162c9ed434c4561125ec1"></a><!-- doxytag: member="CrashRpt.h::crGetLastErrorMsgA" ref="ga33fe8e2555162c9ed434c4561125ec1" args="(LPSTR pszBuffer, UINT uBuffSize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crGetLastErrorMsgA           </td>
          <td>(</td>
          <td class="paramtype">LPSTR&nbsp;</td>
          <td class="paramname"> <em>pszBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UINT&nbsp;</td>
          <td class="paramname"> <em>uBuffSize</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets the last CrashRpt error message. <p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>This function returns length of error message in characters. If output buffer is invalid, returns a negative number.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>pszBuffer</em>&nbsp;</td><td>Pointer to the buffer. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>uBuffSize</em>&nbsp;</td><td>Size of buffer in characters.</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
This function gets the last CrashRpt error message. You can use this function to retrieve the text status of the last called CrashRpt function.<p>
If buffer is too small for the error message, the message is truncated.<p>
<a class="el" href="group___crash_rpt_a_p_i.html#g5cfc01be2fd1c3daf53f21fa553785ae" title="Gets the last CrashRpt error message.">crGetLastErrorMsgW()</a> and <a class="el" href="group___crash_rpt_a_p_i.html#ga33fe8e2555162c9ed434c4561125ec1">crGetLastErrorMsgA()</a> are wide-character and multi-byte character versions of <a class="el" href="group___crash_rpt_a_p_i.html#g062f47d5f7284d72793c60699c7caa33" title="Defines character set-independent mapping for crGetLastErrorMsgW() and crGetLastErrorMsgA()...">crGetLastErrorMsg()</a>. The <a class="el" href="group___crash_rpt_a_p_i.html#g062f47d5f7284d72793c60699c7caa33" title="Defines character set-independent mapping for crGetLastErrorMsgW() and crGetLastErrorMsgA()...">crGetLastErrorMsg()</a> macro defines character set independent mapping.<p>
The following example shows how to use <a class="el" href="group___crash_rpt_a_p_i.html#g062f47d5f7284d72793c60699c7caa33" title="Defines character set-independent mapping for crGetLastErrorMsgW() and crGetLastErrorMsgA()...">crGetLastErrorMsg()</a> function.<p>
<div class="fragment"><pre class="fragment">  <span class="comment">// .. call some CrashRpt function</span>

  <span class="comment">// Get the status message</span>
  TCHAR szErrorMsg[256];
  <a class="code" href="group___crash_rpt_a_p_i.html#g062f47d5f7284d72793c60699c7caa33" title="Defines character set-independent mapping for crGetLastErrorMsgW() and crGetLastErrorMsgA()...">crGetLastErrorMsg</a>(szErrorMsg, 256);
</pre></div><p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group___crash_rpt_a_p_i.html#ga33fe8e2555162c9ed434c4561125ec1">crGetLastErrorMsgA()</a>, <a class="el" href="group___crash_rpt_a_p_i.html#g5cfc01be2fd1c3daf53f21fa553785ae" title="Gets the last CrashRpt error message.">crGetLastErrorMsgW()</a>, <a class="el" href="group___crash_rpt_a_p_i.html#g062f47d5f7284d72793c60699c7caa33" title="Defines character set-independent mapping for crGetLastErrorMsgW() and crGetLastErrorMsgA()...">crGetLastErrorMsg()</a> </dd></dl>
 
</div>
</div><p>
<a class="anchor" name="g5cfc01be2fd1c3daf53f21fa553785ae"></a><!-- doxytag: member="CrashRpt.h::crGetLastErrorMsgW" ref="g5cfc01be2fd1c3daf53f21fa553785ae" args="(LPWSTR pszBuffer, UINT uBuffSize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crGetLastErrorMsgW           </td>
          <td>(</td>
          <td class="paramtype">LPWSTR&nbsp;</td>
          <td class="paramname"> <em>pszBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UINT&nbsp;</td>
          <td class="paramname"> <em>uBuffSize</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets the last CrashRpt error message. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>This function returns length of error message in characters. If output buffer is invalid, returns a negative number.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>pszBuffer</em>&nbsp;</td><td>Pointer to the buffer. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>uBuffSize</em>&nbsp;</td><td>Size of buffer in characters.</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
This function gets the last CrashRpt error message. You can use this function to retrieve the text status of the last called CrashRpt function.<p>
If buffer is too small for the error message, the message is truncated.<p>
<a class="el" href="group___crash_rpt_a_p_i.html#g5cfc01be2fd1c3daf53f21fa553785ae" title="Gets the last CrashRpt error message.">crGetLastErrorMsgW()</a> and <a class="el" href="group___crash_rpt_a_p_i.html#ga33fe8e2555162c9ed434c4561125ec1">crGetLastErrorMsgA()</a> are wide-character and multi-byte character versions of <a class="el" href="group___crash_rpt_a_p_i.html#g062f47d5f7284d72793c60699c7caa33" title="Defines character set-independent mapping for crGetLastErrorMsgW() and crGetLastErrorMsgA()...">crGetLastErrorMsg()</a>. The <a class="el" href="group___crash_rpt_a_p_i.html#g062f47d5f7284d72793c60699c7caa33" title="Defines character set-independent mapping for crGetLastErrorMsgW() and crGetLastErrorMsgA()...">crGetLastErrorMsg()</a> macro defines character set independent mapping.<p>
The following example shows how to use <a class="el" href="group___crash_rpt_a_p_i.html#g062f47d5f7284d72793c60699c7caa33" title="Defines character set-independent mapping for crGetLastErrorMsgW() and crGetLastErrorMsgA()...">crGetLastErrorMsg()</a> function.<p>
<div class="fragment"><pre class="fragment">  <span class="comment">// .. call some CrashRpt function</span>

  <span class="comment">// Get the status message</span>
  TCHAR szErrorMsg[256];
  <a class="code" href="group___crash_rpt_a_p_i.html#g062f47d5f7284d72793c60699c7caa33" title="Defines character set-independent mapping for crGetLastErrorMsgW() and crGetLastErrorMsgA()...">crGetLastErrorMsg</a>(szErrorMsg, 256);
</pre></div><p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group___crash_rpt_a_p_i.html#ga33fe8e2555162c9ed434c4561125ec1">crGetLastErrorMsgA()</a>, <a class="el" href="group___crash_rpt_a_p_i.html#g5cfc01be2fd1c3daf53f21fa553785ae" title="Gets the last CrashRpt error message.">crGetLastErrorMsgW()</a>, <a class="el" href="group___crash_rpt_a_p_i.html#g062f47d5f7284d72793c60699c7caa33" title="Defines character set-independent mapping for crGetLastErrorMsgW() and crGetLastErrorMsgA()...">crGetLastErrorMsg()</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="g18a7a7421e1522f787ba451eaf424b0e"></a><!-- doxytag: member="CrashRpt.h::crInstallA" ref="g18a7a7421e1522f787ba451eaf424b0e" args="(PCR_INSTALL_INFOA pInfo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crInstallA           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_c_r___i_n_s_t_a_l_l___i_n_f_o_a.html">PCR_INSTALL_INFOA</a>&nbsp;</td>
          <td class="paramname"> <em>pInfo</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Installs exception handlers for the caller process. <p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pInfo</em>&nbsp;</td><td>General information.</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd>This function installs unhandled exception filter for the caller process. It also installs various CRT exception/error handlers that function for all threads of the caller process. For more information, see <a class="el" href="exception_handling.html">About Exceptions and Exception Handling</a></dd></dl>
Below is the list of installed handlers:<ul>
<li>Top-level SEH exception filter [ <code>SetUnhandledExceptionFilter()</code> ]</li><li>C++ pure virtual call handler (Visual Studio .NET 2003 and later) [ <code>_set_purecall_handler()</code> ]</li><li>C++ invalid parameter handler (Visual Studio .NET 2005 and later) [ <code>_set_invalid_parameter_handler()</code> ]</li><li>C++ new operator error handler (Visual Studio .NET 2003 and later) [ <code>_set_new_handler()</code> ]</li><li>C++ buffer overrun handler (Visual Studio .NET 2003 only) [ <code>_set_security_error_handler()</code> ]</li><li>C++ abort handler [ <code>signal(SIGABRT)</code> ]</li><li>C++ illegal instruction handler [ <code>signal(SIGINT)</code> ]</li><li>C++ termination request [ <code>signal(SIGTERM)</code> ]</li></ul>
<p>
In a multithreaded program, additionally use <a class="el" href="group___crash_rpt_a_p_i.html#g6fe5cff31697f687b29dc73cd34d72b4" title="Installs exception handlers to the caller thread.">crInstallToCurrentThread2()</a> function for each execution thread, except the main one.<p>
The <em>pInfo</em> parameter contains all required information needed to install CrashRpt.<p>
This function fails when <em>pInfo-&gt;pszCrashSenderPath</em> doesn't contain valid path to CrashSender.exe or when <em>pInfo-&gt;pszCrashSenderPath</em> is equal to NULL, but <b>CrashSender.exe</b> is not located in the directory where <b>CrashRpt.dll</b> located.<p>
On crash, the crash minidump file is created, which contains CPU information and stack trace information. Also XML file is created that contains additional information that may be helpful for crash analysis. These files along with several additional files added with <a class="el" href="group___crash_rpt_a_p_i.html#g382c00cf76818ba1a66eb89715a030ea" title="Character set-independent mapping of crAddFile2W() and crAddFile2A() functions.">crAddFile2()</a> are packed to a single ZIP file.<p>
When crash information is collected, another process, <b>CrashSender.exe</b>, is launched and the process where crash had occured is terminated. The CrashSender process is responsible for letting the user know about the crash and send the error report.<p>
The error report can be sent over E-mail using address and subject passed to the function as <a class="el" href="group___crash_rpt_structs.html#g61e78b3a8180a386e7a40ecf125e5c1d">CR_INSTALL_INFO</a> structure members. Another way of sending error report is an HTTP request using <em>pszUrl</em> member of <a class="el" href="group___crash_rpt_structs.html#g61e78b3a8180a386e7a40ecf125e5c1d">CR_INSTALL_INFO</a>.<p>
This function may fail if an appropriate language file (<b>crashrpt_lang.ini</b>) is not found in the directory where the <b>CrashSender.exe</b> file is located.<p>
If this function fails, use <a class="el" href="group___crash_rpt_a_p_i.html#g062f47d5f7284d72793c60699c7caa33" title="Defines character set-independent mapping for crGetLastErrorMsgW() and crGetLastErrorMsgA()...">crGetLastErrorMsg()</a> to retrieve the error message.<p>
<a class="el" href="group___crash_rpt_a_p_i.html#gc1f98f531d9a1c67f090768ce4316ffd" title="Installs exception handlers for the caller process.">crInstallW()</a> and <a class="el" href="group___crash_rpt_a_p_i.html#g18a7a7421e1522f787ba451eaf424b0e">crInstallA()</a> are wide-character and multi-byte character versions of <a class="el" href="group___crash_rpt_a_p_i.html#g24acb589d629460590d85735e12b5337" title="Character set-independent mapping of crInstallW() and crInstallA() functions.">crInstall()</a> function. The <a class="el" href="group___crash_rpt_a_p_i.html#g24acb589d629460590d85735e12b5337">crInstall</a> macro defines character set independent mapping for these functions.<p>
For code example, see <a class="el" href="simple_example.html">An Example of Using API</a>.<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group___crash_rpt_a_p_i.html#gc1f98f531d9a1c67f090768ce4316ffd" title="Installs exception handlers for the caller process.">crInstallW()</a>, <a class="el" href="group___crash_rpt_a_p_i.html#g18a7a7421e1522f787ba451eaf424b0e">crInstallA()</a>, <a class="el" href="group___crash_rpt_a_p_i.html#g24acb589d629460590d85735e12b5337" title="Character set-independent mapping of crInstallW() and crInstallA() functions.">crInstall()</a>, <a class="el" href="struct_c_r___i_n_s_t_a_l_l___i_n_f_o_w.html" title="This structure defines the general information used by crInstall().">CR_INSTALL_INFOW</a>, <a class="el" href="struct_c_r___i_n_s_t_a_l_l___i_n_f_o_a.html">CR_INSTALL_INFOA</a>, <a class="el" href="group___crash_rpt_structs.html#g61e78b3a8180a386e7a40ecf125e5c1d" title="Character set-independent mapping of CR_INSTALL_INFOW and CR_INSTALL_INFOA structures...">CR_INSTALL_INFO</a>, <a class="el" href="group___crash_rpt_a_p_i.html#gb5ff3a104014a1e138878a1882822442" title="Unsinstalls exception handlers previously installed with crInstall().">crUninstall()</a>, <a class="el" href="class_cr_auto_install_helper.html" title="Installs exception handlers in constructor and uninstalls in destructor.">CrAutoInstallHelper</a> </dd></dl>
 
</div>
</div><p>
<a class="anchor" name="g6fe5cff31697f687b29dc73cd34d72b4"></a><!-- doxytag: member="CrashRpt.h::crInstallToCurrentThread2" ref="g6fe5cff31697f687b29dc73cd34d72b4" args="(DWORD dwFlags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crInstallToCurrentThread2           </td>
          <td>(</td>
          <td class="paramtype">DWORD&nbsp;</td>
          <td class="paramname"> <em>dwFlags</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Installs exception handlers to the caller thread. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>This function returns zero if succeeded. </dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dwFlags</em>&nbsp;</td><td>Flags.</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
This function is available <b>since v.1.1.2</b>.<p>
The function sets exception handlers for the caller thread. If you have several execution threads, you ought to call the function for each thread, except the main one.<p>
The function works the same way as obsolete <a class="el" href="group___deprecated_a_p_i.html#g7a9a699378388487a725689d6571e7cb" title="Installs exception handlers to the current thread.">crInstallToCurrentThread()</a>, but provides an ability to select what exception handlers to install.<p>
<em>dwFlags</em> defines what exception handlers to install. Use zero value to install all possible exception handlers. Or use a combination of the following constants:<p>
<ul>
<li><a class="el" href="_crash_rpt_8h.html#9b429099fbc3627873d37b8b8cb44bd1">CR_INST_TERMINATE_HANDLER</a> Install terminate handler</li><li><a class="el" href="_crash_rpt_8h.html#fa31743e1673876a4c9dbe5141116ea3">CR_INST_UNEXPECTED_HANDLER</a> Install unexpected handler</li><li><a class="el" href="_crash_rpt_8h.html#61612dfcc4cc11019d885ec14aabe63d">CR_INST_SIGFPE_HANDLER</a> Install SIGFPE signal handler</li><li><a class="el" href="_crash_rpt_8h.html#c404949a38e9d4893f0167733c1536ab">CR_INST_SIGILL_HANDLER</a> Install SIGILL signal handler</li><li><a class="el" href="_crash_rpt_8h.html#05c9bd9db5e7e3c474afb82a306db01b">CR_INST_SIGSEGV_HANDLER</a> Install SIGSEGV signal handler</li></ul>
<p>
Example:<p>
<div class="fragment"><pre class="fragment">   DWORD WINAPI ThreadProc(LPVOID lpParam)
   {
     <span class="comment">// Install exception handlers</span>
     <a class="code" href="group___crash_rpt_a_p_i.html#g6fe5cff31697f687b29dc73cd34d72b4" title="Installs exception handlers to the caller thread.">crInstallToCurrentThread2</a>(0);

     <span class="comment">// Your code...</span>

     <span class="comment">// Uninstall exception handlers</span>
     <a class="code" href="group___crash_rpt_a_p_i.html#gaf56dbee81338534d96ab23f694be43c" title="Uninstalls C++ exception handlers from the current thread.">crUninstallFromCurrentThread</a>();
    
     <span class="keywordflow">return</span> 0;
   }
</pre></div><p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group___deprecated_a_p_i.html#g7a9a699378388487a725689d6571e7cb" title="Installs exception handlers to the current thread.">crInstallToCurrentThread()</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="gc1f98f531d9a1c67f090768ce4316ffd"></a><!-- doxytag: member="CrashRpt.h::crInstallW" ref="gc1f98f531d9a1c67f090768ce4316ffd" args="(PCR_INSTALL_INFOW pInfo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crInstallW           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_c_r___i_n_s_t_a_l_l___i_n_f_o_w.html">PCR_INSTALL_INFOW</a>&nbsp;</td>
          <td class="paramname"> <em>pInfo</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Installs exception handlers for the caller process. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pInfo</em>&nbsp;</td><td>General information.</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd>This function installs unhandled exception filter for the caller process. It also installs various CRT exception/error handlers that function for all threads of the caller process. For more information, see <a class="el" href="exception_handling.html">About Exceptions and Exception Handling</a></dd></dl>
Below is the list of installed handlers:<ul>
<li>Top-level SEH exception filter [ <code>SetUnhandledExceptionFilter()</code> ]</li><li>C++ pure virtual call handler (Visual Studio .NET 2003 and later) [ <code>_set_purecall_handler()</code> ]</li><li>C++ invalid parameter handler (Visual Studio .NET 2005 and later) [ <code>_set_invalid_parameter_handler()</code> ]</li><li>C++ new operator error handler (Visual Studio .NET 2003 and later) [ <code>_set_new_handler()</code> ]</li><li>C++ buffer overrun handler (Visual Studio .NET 2003 only) [ <code>_set_security_error_handler()</code> ]</li><li>C++ abort handler [ <code>signal(SIGABRT)</code> ]</li><li>C++ illegal instruction handler [ <code>signal(SIGINT)</code> ]</li><li>C++ termination request [ <code>signal(SIGTERM)</code> ]</li></ul>
<p>
In a multithreaded program, additionally use <a class="el" href="group___crash_rpt_a_p_i.html#g6fe5cff31697f687b29dc73cd34d72b4" title="Installs exception handlers to the caller thread.">crInstallToCurrentThread2()</a> function for each execution thread, except the main one.<p>
The <em>pInfo</em> parameter contains all required information needed to install CrashRpt.<p>
This function fails when <em>pInfo-&gt;pszCrashSenderPath</em> doesn't contain valid path to CrashSender.exe or when <em>pInfo-&gt;pszCrashSenderPath</em> is equal to NULL, but <b>CrashSender.exe</b> is not located in the directory where <b>CrashRpt.dll</b> located.<p>
On crash, the crash minidump file is created, which contains CPU information and stack trace information. Also XML file is created that contains additional information that may be helpful for crash analysis. These files along with several additional files added with <a class="el" href="group___crash_rpt_a_p_i.html#g382c00cf76818ba1a66eb89715a030ea" title="Character set-independent mapping of crAddFile2W() and crAddFile2A() functions.">crAddFile2()</a> are packed to a single ZIP file.<p>
When crash information is collected, another process, <b>CrashSender.exe</b>, is launched and the process where crash had occured is terminated. The CrashSender process is responsible for letting the user know about the crash and send the error report.<p>
The error report can be sent over E-mail using address and subject passed to the function as <a class="el" href="group___crash_rpt_structs.html#g61e78b3a8180a386e7a40ecf125e5c1d">CR_INSTALL_INFO</a> structure members. Another way of sending error report is an HTTP request using <em>pszUrl</em> member of <a class="el" href="group___crash_rpt_structs.html#g61e78b3a8180a386e7a40ecf125e5c1d">CR_INSTALL_INFO</a>.<p>
This function may fail if an appropriate language file (<b>crashrpt_lang.ini</b>) is not found in the directory where the <b>CrashSender.exe</b> file is located.<p>
If this function fails, use <a class="el" href="group___crash_rpt_a_p_i.html#g062f47d5f7284d72793c60699c7caa33" title="Defines character set-independent mapping for crGetLastErrorMsgW() and crGetLastErrorMsgA()...">crGetLastErrorMsg()</a> to retrieve the error message.<p>
<a class="el" href="group___crash_rpt_a_p_i.html#gc1f98f531d9a1c67f090768ce4316ffd" title="Installs exception handlers for the caller process.">crInstallW()</a> and <a class="el" href="group___crash_rpt_a_p_i.html#g18a7a7421e1522f787ba451eaf424b0e">crInstallA()</a> are wide-character and multi-byte character versions of <a class="el" href="group___crash_rpt_a_p_i.html#g24acb589d629460590d85735e12b5337" title="Character set-independent mapping of crInstallW() and crInstallA() functions.">crInstall()</a> function. The <a class="el" href="group___crash_rpt_a_p_i.html#g24acb589d629460590d85735e12b5337">crInstall</a> macro defines character set independent mapping for these functions.<p>
For code example, see <a class="el" href="simple_example.html">An Example of Using API</a>.<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group___crash_rpt_a_p_i.html#gc1f98f531d9a1c67f090768ce4316ffd" title="Installs exception handlers for the caller process.">crInstallW()</a>, <a class="el" href="group___crash_rpt_a_p_i.html#g18a7a7421e1522f787ba451eaf424b0e">crInstallA()</a>, <a class="el" href="group___crash_rpt_a_p_i.html#g24acb589d629460590d85735e12b5337" title="Character set-independent mapping of crInstallW() and crInstallA() functions.">crInstall()</a>, <a class="el" href="struct_c_r___i_n_s_t_a_l_l___i_n_f_o_w.html" title="This structure defines the general information used by crInstall().">CR_INSTALL_INFOW</a>, <a class="el" href="struct_c_r___i_n_s_t_a_l_l___i_n_f_o_a.html">CR_INSTALL_INFOA</a>, <a class="el" href="group___crash_rpt_structs.html#g61e78b3a8180a386e7a40ecf125e5c1d" title="Character set-independent mapping of CR_INSTALL_INFOW and CR_INSTALL_INFOA structures...">CR_INSTALL_INFO</a>, <a class="el" href="group___crash_rpt_a_p_i.html#gb5ff3a104014a1e138878a1882822442" title="Unsinstalls exception handlers previously installed with crInstall().">crUninstall()</a>, <a class="el" href="class_cr_auto_install_helper.html" title="Installs exception handlers in constructor and uninstalls in destructor.">CrAutoInstallHelper</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="gb5ff3a104014a1e138878a1882822442"></a><!-- doxytag: member="CrashRpt.h::crUninstall" ref="gb5ff3a104014a1e138878a1882822442" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crUninstall           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Unsinstalls exception handlers previously installed with <a class="el" href="group___crash_rpt_a_p_i.html#g24acb589d629460590d85735e12b5337" title="Character set-independent mapping of crInstallW() and crInstallA() functions.">crInstall()</a>. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>This function returns zero if succeeded.</dd></dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
Call this function on application exit to uninstall exception handlers previously installed with <a class="el" href="group___crash_rpt_a_p_i.html#g24acb589d629460590d85735e12b5337" title="Character set-independent mapping of crInstallW() and crInstallA() functions.">crInstall()</a>. After function call, the exception handlers are restored to states they had before calling <a class="el" href="group___crash_rpt_a_p_i.html#g24acb589d629460590d85735e12b5337" title="Character set-independent mapping of crInstallW() and crInstallA() functions.">crInstall()</a>.<p>
This function fails if <a class="el" href="group___crash_rpt_a_p_i.html#g24acb589d629460590d85735e12b5337" title="Character set-independent mapping of crInstallW() and crInstallA() functions.">crInstall()</a> wasn't previously called in context of the caller process.<p>
When this function fails, use <a class="el" href="group___crash_rpt_a_p_i.html#g062f47d5f7284d72793c60699c7caa33" title="Defines character set-independent mapping for crGetLastErrorMsgW() and crGetLastErrorMsgA()...">crGetLastErrorMsg()</a> to retrieve the error message.<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group___crash_rpt_a_p_i.html#gc1f98f531d9a1c67f090768ce4316ffd" title="Installs exception handlers for the caller process.">crInstallW()</a>, <a class="el" href="group___crash_rpt_a_p_i.html#g18a7a7421e1522f787ba451eaf424b0e">crInstallA()</a>, <a class="el" href="group___crash_rpt_a_p_i.html#g24acb589d629460590d85735e12b5337" title="Character set-independent mapping of crInstallW() and crInstallA() functions.">crInstall()</a>, <a class="el" href="group___crash_rpt_a_p_i.html#gb5ff3a104014a1e138878a1882822442" title="Unsinstalls exception handlers previously installed with crInstall().">crUninstall()</a>, <a class="el" href="class_cr_auto_install_helper.html" title="Installs exception handlers in constructor and uninstalls in destructor.">CrAutoInstallHelper</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="gaf56dbee81338534d96ab23f694be43c"></a><!-- doxytag: member="CrashRpt.h::crUninstallFromCurrentThread" ref="gaf56dbee81338534d96ab23f694be43c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crUninstallFromCurrentThread           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Uninstalls C++ exception handlers from the current thread. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>This function returns zero if succeeded.</dd></dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
This function unsets exception handlers from the caller thread. If you have several execution threads, you ought to call the function for each thread. After calling this function, the exception handlers for current thread are replaced with the handlers that were before call of <a class="el" href="group___crash_rpt_a_p_i.html#g6fe5cff31697f687b29dc73cd34d72b4" title="Installs exception handlers to the caller thread.">crInstallToCurrentThread2()</a>.<p>
This function fails if <a class="el" href="group___crash_rpt_a_p_i.html#g6fe5cff31697f687b29dc73cd34d72b4" title="Installs exception handlers to the caller thread.">crInstallToCurrentThread2()</a> wasn't called for current thread.<p>
When this function fails, use <a class="el" href="group___crash_rpt_a_p_i.html#g062f47d5f7284d72793c60699c7caa33" title="Defines character set-independent mapping for crGetLastErrorMsgW() and crGetLastErrorMsgA()...">crGetLastErrorMsg()</a> to retrieve the error message.<p>
No need to call this function for the main execution thread. The <a class="el" href="group___crash_rpt_a_p_i.html#gb5ff3a104014a1e138878a1882822442" title="Unsinstalls exception handlers previously installed with crInstall().">crUninstall()</a> will automatically uninstall C++ exception handlers for the main thread.<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group___deprecated_a_p_i.html#g7a9a699378388487a725689d6571e7cb" title="Installs exception handlers to the current thread.">crInstallToCurrentThread()</a>, <a class="el" href="group___crash_rpt_a_p_i.html#g6fe5cff31697f687b29dc73cd34d72b4" title="Installs exception handlers to the caller thread.">crInstallToCurrentThread2()</a>, <a class="el" href="group___crash_rpt_a_p_i.html#gaf56dbee81338534d96ab23f694be43c" title="Uninstalls C++ exception handlers from the current thread.">crUninstallFromCurrentThread()</a>, <a class="el" href="class_cr_thread_auto_install_helper.html" title="Installs (uninstalls) exception handlers for the caller thread in class&#39; constructor...">CrThreadAutoInstallHelper</a> </dd></dl>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Tue Feb 15 19:41:00 2011 for CrashRpt by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.9 </small></address>
</body>
</html>
